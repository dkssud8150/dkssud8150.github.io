<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="[데브코스] 12주차 - DeepLearning Data Labeling and Data Augmentation" /><meta name="author" content="JaeHo YooN" /><meta property="og:locale" content="en" /><meta name="description" content="Do focus on developing ‘your ability’ rather than waste time on making you famous." /><meta property="og:description" content="Do focus on developing ‘your ability’ rather than waste time on making you famous." /><link rel="canonical" href="https://dkssud8150.github.io/posts/labeling/" /><meta property="og:url" content="https://dkssud8150.github.io/posts/labeling/" /><meta property="og:site_name" content="JaeHo Yoon" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-04T15:20:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[데브코스] 12주차 - DeepLearning Data Labeling and Data Augmentation" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@JaeHo YooN" /><meta name="google-site-verification" content="znvuGsQGYxMZPBslC4XG6doCYao6Y-fWibfGlcaMHH8" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"JaeHo YooN"},"dateModified":"2023-01-05T10:31:37+09:00","datePublished":"2022-05-04T15:20:00+09:00","description":"Do focus on developing ‘your ability’ rather than waste time on making you famous.","headline":"[데브코스] 12주차 - DeepLearning Data Labeling and Data Augmentation","mainEntityOfPage":{"@type":"WebPage","@id":"https://dkssud8150.github.io/posts/labeling/"},"url":"https://dkssud8150.github.io/posts/labeling/"}</script><title>[데브코스] 12주차 - DeepLearning Data Labeling and Data Augmentation | JaeHo Yoon</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="JaeHo Yoon"><meta name="application-name" content="JaeHo Yoon"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/shin_chan.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">JaeHo Yoon</a></div><div class="site-subtitle font-italic">Mamba Mentality</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fab fa-angellist ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/dkssud8150" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hoya58150','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.notion.so/18490713817d403696812c57d0abe730" aria-label="notion" target="_blank" rel="noopener"> <i class="fab fa-battle-net"></i> </a> <a href="https://www.linkedin.com/in/jaeho-yoon-90b62b230" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.instagram.com/jai_ho8150/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[데브코스] 12주차 - DeepLearning Data Labeling and Data Augmentation</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[데브코스] 12주차 - DeepLearning Data Labeling and Data Augmentation</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/dkssud8150">JaeHo YooN</a> </em></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6611243953442169" crossorigin="anonymous"></script><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-05-04 15:20:00 +0900" data-toggle="tooltip" data-placement="bottom" title="Wed, May 4, 2022, 3:20 PM +0900" >May 4, 2022</em> </span> <span> Updated <em class="timeago" date="2023-01-05 10:31:37 +0900 " data-toggle="tooltip" data-placement="bottom" title="Thu, Jan 5, 2023, 10:31 AM +0900" >Jan 5</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4961 words"> <em>27 min</em> read</span></div></div></div><div class="post-content"><p><br /></p><h1 id="data-labeling">Data Labeling</h1><p>labeling이란 확보한 원시 데이터(raw data)를 학습에 사용하기 위해 데이터를 만드는 작업을 말한다. 레이블링(<strong>Labeling</strong>) 또는 어노테이션(<strong>Annotation</strong>), 태깅(Tagging)이라 부른다. Computer vision에서는 주로 이미지에 필요한 태스크(classification, detection,..)에 대해 결과를 미리 입력하는 작업이다. 분류의 경우는 이미지에 해당하는 클래스 정보를 입력하고, detection에 경우 이미지에 대상 객체의 bbox와 클래스 정보를 입력해야 한다.</p><p>데이터를 잘못 만드는 경우 결과는 당연히 좋지 않을 것이다. 그래서 데이터 레이블링을 하는 툴을 하나 정도는 다룰 줄 아는 것이 중요하다. 데이터를 만들어야 하는 상황은 가지고 있는 데이터셋과는 다른 환경과 조건에 대한 데이터도 함께 학습을 시키고 싶다면, 자신이 얻은 데이터셋을 직접 레이블링해서 추가할수도 있다. 또는 가상환경에서의 데이터와 현실환경에서의 데이터를 융합해서 데이터 증강을 통해 학습을 시킬수도 있을 것이다.</p><p>데이터를 다루는 작업이 필요한 이유는 데이터의 개수는 한계적인데, 모델의 성능은 데이터의 수가 많을수록 올라간다. 실제로 2~3TB의 데이터를 직접 제작하기도 하기 때문에 중요한 작업이다.</p><p><br /></p><h2 id="data-labeling-tool">Data labeling Tool <a href="#data-labeling-tool" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>이미지 데이터를 레이블링하는 툴은 CVAT, labelme, labelImg 등 많이 있다.</p><h3 id="cvat">CVAT <a href="#cvat" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p><a href="https://opencv.github.io/cvat/docs/administration/basics/installation/">설치 홈페이지</a></p><p>CVAT는 Docker Image를 제공하여 편리하게 설치할 수 있다.</p><p><br /></p><p><br /></p><h4 id="wsl-설치">WSL 설치 <a href="#wsl-설치" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>window에 wsl2를 설치하면 윈도우 커널에서 linux 환경을 사용할 수 있다. 이를 설치하면 대체로 linux 커널을 자주 바꿔줄 필요가 없어진다. 실제 자율주행과 동일한 임베디드 환경을 사용하거나 멀티 카메라를 받아서 사용할 때는 리눅스를 써야할 수 있지만, 이를 제외하고는 wsl2가 편리하다. wsl2에서는 GPU Device를 linux 커널에서 사용할 수 있어서 window환경에서 linux/ubuntu 기반의 tensorflow, pytorch, cuda 등 다양한 환경을 구성할 수 있다.</p><p>wsl1에서는 gpu를 사용하기 어려웠고, linux에서의 opencv에서 show를 하기 복잡했다. 그러나 wsl2로 넘어오면서 바로 사용이 가능해졌다.</p><p><br /></p><p>wsl 설치 홈페이지 : https://docs.microsoft.com/en-us/windows/wsl/install</p><p>설치 전 윈도우 버전을 반드시 확인해야 한다.</p><p>위의 홈페이지로 들어가면 WSL 설치 과정이 나와있고, 1과 2가 통합되면서 설치가 간단해졌다.</p><ul><li>wsl 패키지 설치</ul><p>관리자 권한으로 powershell 이나 cmd를 실행하여 wsl 기능을 설치한다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wsl <span class="nt">--install</span>
</pre></table></code></div></div><ul><li>ubuntu 배포판 설치</ul><p>microsoft store에서 ubuntu 20.04나 18.04를 설치한다. 여기서 LTS는 lone term support 라고 해서 장기간에 걸쳐 지원하도록 만든 소프트웨어 버전이다. 가장 최신버전인 22.04도 지원하고 있다.</p><p>20.04 까지는 systemd를 사용할 수 없지만, 22.04부터는 systemd를 사용할 수 있다고 한다.</p><p><br /></p><p>설치가 끝나고 실행하면 계정을 설정하라고 나온다. 자신이 사용할 계정을 설정해주면 된다. 이 프로그램은 ubuntu와 동일하기 때문에 gcc나 ubuntu에서 사용 가능한 명령어들을 사용할 수 있다.</p><p><img data-src="/assets/img/dev/week12/day3/ubuntu.png" data-proofer-ignore></p><p>설정한 계정이름은 매 줄마다 표시되는 이름이자 이 os의 계정 이름이다. 그리고 비밀번호는 재설정이 불가능하기 때문에 까먹는다면 ubuntu를 재설치해야 하므로 신중히 생성하도록 한다.</p><p><br /></p><p><br /></p><h4 id="docker">docker <a href="#docker" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>최신 노트북들이 20.04 ubuntu버전이 아닌 18.04를 하면 네트워크가 잘 안잡히거나 소리가 안나는 문제들이 많다. 그래서 메인 os는 20.04로 하되 docker로 18.04 컨테이너를 만들면 따로 18.04 ubuntu 버전을 설치할 필요가 없다. 따라서 WSL2와 docker를 사용하는데 익숙해지면 환경을 구축하는데 드는 비용이 감소하고, 다른 사람들에게도 손쉽게 실행 가능한 환경을 구축할 수 있다.</p><p>docker를 사용할 때 window에서는 <a href="https://www.docker.com/products/docker-desktop/">docker desktop</a>을 사용할 수 있지만, linux의 경우는 cli에서만 사용이 가능하다.</p><p><br /></p><p>docker desktop을 다 다운 받았다면 다음 화면이 나올 것이다.</p><p><img data-src="/assets/img/dev/week12/day3/dockerdesktop.png" data-proofer-ignore></p><p>이는 튜토리얼이므로 스킵을 해도 되고 따라가도 된다. git clone을 할 경우는 오른쪽의 command를 통해 CVAT을 설치한다. 그러나 어차피 튜토리얼이 종료되면 다시 up을 해야하므로 스킵해서 하는 것이 좋다.</p><p><br /></p><p>스킵을 하거나 튜토리얼을 끝내고 나면, 아래와 같은 화면이 뜬다.</p><p><img data-src="/assets/img/dev/week12/day3/dockerdesktopmain.png" data-proofer-ignore></p><p>여기서 cmd를 하나 켜서 작업할 폴더에 들어간 후 화면에 보이는 코드를 복사하여 그대로 붙여넣는다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run <span class="nt">-d</span> <span class="nt">-p</span> 80:80 docker/getting-started
</pre></table></code></div></div><p>-p는 port를 뜻한다. 이를 치면 image가 없다고 뜨면서 설치하게 된다. 설치가 완료되면, 다음 코드를 친다.</p><p><br /></p><h4 id="cvat-install-in-window">CVAT install in Window <a href="#cvat-install-in-window" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>원래는 window에서 docker를 사용하면 docker가 window를 참조하게 되어 있지만, window에서 wsl을 사용하는 곳에 docker를 올리게 되면, docker가 linux(wsl)을 참조하게 된다. 그래서 window + wsl + docker를 사용할 때는 window → wsl → docker 순으로 올려진다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>git clone https://github.com/opencv/cvat
<span class="nb">cd </span>cvat

docker-compose up <span class="nt">-d</span>
</pre></table></code></div></div><p>뒤의 -d는 daemon을 뜻하는 것으로 background process로 동작을 시키겠다는 의미이다. linux를 사용하다보면 daemon이 되게 많이 등장한다.</p><p><br /></p><p>설치가 완료되면 아래와 같이 CVAT에 대한 컨테이너가 생성된다.</p><p><img data-src="/assets/img/dev/week12/day3/dockerdesktopcvat.png" data-proofer-ignore></p><p><br /></p><p><br /></p><h4 id="cvat-install-in-ubuntu">CVAT install in Ubuntu <a href="#cvat-install-in-ubuntu" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>위의 과정은 window에서의 CVAT 설치 방법이었고, 이제는 ubuntu에서 CVAT을 설치하는 방법을 소개한다.</p><p>설치에 대한 설명 사이트는 https://docs.docker.com/engine/install/ubuntu/ 이고, docker desktop과 달리 linux는 CLI 환경에서 설치해야 한다.</p><p>docker를 사용할 때 권한 문제가 발생할 수 있다. 이 때는 <code class="language-plaintext highlighter-rouge">sudo su-</code>를 사용하는 것보다 유저 그룹에 docker를 추가하면 편리하게 사용이 가능하다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>groupadd docker
<span class="nv">$ </span><span class="nb">sudo </span>usermod <span class="nt">-aG</span> docker <span class="nv">$USER</span>
</pre></table></code></div></div><p>그룹에 docker를 추가하고, user 그룹에 docker 그룹을 추가하는 코드이다.</p><p>그 후 docker-compose 패키지를 설치하고, CVAT 레포지토리를 불러온다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>apt <span class="nt">--no-install-recommands</span> <span class="nb">install</span> <span class="nt">-y</span> python3-pip python3-setuptools
<span class="nv">$ </span><span class="nb">sudo </span>python3 <span class="nt">-m</span> pip <span class="nb">install </span>setuptools docker-compose
<span class="nv">$ </span><span class="nb">sudo </span>apt <span class="nt">--no-install-recommands</span> <span class="nb">install</span> <span class="nt">-y</span> git
<span class="nv">$ </span>git clone https://github.com/opencv/cvat
<span class="nv">$ </span><span class="nb">cd </span>cvat
</pre></table></code></div></div><p>그 후 CVAT을 공용 컴퓨터에 넣고, 다수의 사람들이 접근을 해서 사용할수 있는데, 이 때 HOST를 설정해줘야 하므로 아래의 코드를 설정해줘야 한다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ifconfig
<span class="nv">$ </span><span class="nb">export </span><span class="nv">CVAT_HOST</span><span class="o">=</span>my-ip-address
</pre></table></code></div></div><p>윈도우에서 ip주소를 확인할 때는 <code class="language-plaintext highlighter-rouge">ipconfig</code>이다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker-compose up <span class="nt">-d</span>
</pre></table></code></div></div><p><br /></p><p><br /></p><h4 id="cvat-create-account">CVAT create account <a href="#cvat-create-account" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>window 또는 ubuntu에서 모든 설치가 끝나고 나서 만약 CVAT_HOST를 설정하지 않았다면 다음 주소를 입력해서 들어가야 한다. http://localhost:8080/auth/login</p><p><img data-src="/assets/img/dev/week12/day3/cvatlogin.png" data-proofer-ignore></p><p>CVAT_HOST를 설정했다면, http://{IP address}:PORT/auth/login 를 통해 공용 컴퓨터로 접속이 가능하고, 위의 화면에서 각자의 계정이 존재해야 하므로 계정을 생성한다. 누가 어떤 작업을 하는지 다른 사람이 볼 수 있어야 겹치는 일이 없다.</p><p><br /></p><p><br /></p><p><img data-src="/assets/img/dev/week12/day3/cvatmain.png" data-proofer-ignore></p><p>이 화면은 메인 페이지이고, CVAT의 작업 단위는 3단계로 구성되어 있다. 가장 큰 단위는 <strong>Projects</strong> 이고, 그 밑에 여러 개의 <strong>task</strong>가 존재한다. task에는 classification task, detection task, segmentation task 등이 존재할 것이고, 그 밑에 <strong>Job</strong>이라는 이미지 단위가 존재한다. 만약 한 task가 1만장을 10명에서 진행한다고 가정할 때, 하나의 task로 작업하다가 task가 날아가거나 삭제되면 모든 작업이 리셋되는 것이므로, 특정 N개의 이미지를 기준으로 job 단위로 나누어 작업을 수행한다.</p><p><br /></p><h4 id="cvat-make-task">CVAT make Task <a href="#cvat-make-task" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>메인 화면에서 프로젝트를 생성해도 되고, task를 새로 생성해도 되는데, 현재는 task만 생성해볼 것이다. <code class="language-plaintext highlighter-rouge">+</code>를 눌러 <code class="language-plaintext highlighter-rouge">create a new task</code>를 클릭한다.</p><p><img data-src="/assets/img/dev/week12/day3/createtask.png" data-proofer-ignore></p><p>그러면 이렇게 화면이 하나 뜬다.</p><ul><li>Name : task의 이름<li>Project : 연결시킬 project 이름<li>labels : 원하는 클래스를 원하는 색상으로 추가하는 기능이고, 이는 포함되어 있는 job들이 이 label을 공유하기 때문에 잘 정의해줘야 한다.<li>select files : labeling할 이미지를 직접 업로드하는 기능이다.<li>advanced configuration : 상세옵션으로, 이미지 퀄리티나 태스크, job의 개수 등을 지정할 수 있는 기능이다.</ul><p><br /></p><p>생성하고 나면 생성 시 설정한 이미지 개수로 자동 구성되고, 어느 정도 진행이 되고 있는지 확인할 수 있다.</p><p><img data-src="/assets/img/dev/week12/day3/task.png" data-proofer-ignore></p><p><br /></p><p><br /></p><p>CVAT은 labeling 한 데이터를 배포할 때 kitti, bdd100k, cityscape, yolo 등 다양한 포맷의 데이터로 변환이 가능하다.</p><p><img data-src="/assets/img/dev/week12/day3/exportlabel.png" data-proofer-ignore></p><p><br /></p><p><br /></p><p><br /></p><h4 id="cvat-make-project">CVAT make Project <a href="#cvat-make-project" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>상단의 탭에서 project를 누른 후 <code class="language-plaintext highlighter-rouge">+</code> -&gt; <code class="language-plaintext highlighter-rouge">create new project</code> 를 클릭한다.</p><p><img data-src="/assets/img/dev/week12/day3/createproject.png" data-proofer-ignore></p><p>이름과 label을 지정해준 후 submit한 후 open projects를 누르게 되면 생성된 project를 확인할 수 있다.</p><p><img data-src="/assets/img/dev/week12/day3/madeproject.png" data-proofer-ignore></p><p>현재는 task가 없으므로 하단에 <code class="language-plaintext highlighter-rouge">+</code>를 눌러 task를 생성한다. 이름을 지정해주고, advanced configuration에서 image quality를 보면 현재는 70%이다. 그 이유는 원본 그대로를 올리게 되면 부담이 될 수 있기 때문이다. 그러나 우리는 이미지를 아주 작게 진행할 것이므로 100으로 지정해주고, job을 구분할 때 사용하는 segment size를 2로 한다. 2로 주게 되면 이미지 개수를 2로 하여 job을 구분한다.</p><p><img data-src="/assets/img/dev/week12/day3/advanced.png" data-proofer-ignore></p><p><img data-src="/assets/img/dev/week12/day3/selectfile.png" data-proofer-ignore></p><p>이미지를 업로드한 후 submit한다.</p><p><img data-src="/assets/img/dev/week12/day3/madetask.png" data-proofer-ignore></p><p><br /></p><p>동일한 방식으로 task를 하나 더 생성한다.</p><p><img data-src="/assets/img/dev/week12/day3/made2task.png" data-proofer-ignore></p><p><br /></p><p>object detection을 먼저 진행해보자. task에서 open을 누르고, 첫번째 job을 클릭한다.</p><p><img data-src="/assets/img/dev/week12/day3/cvatod.png" data-proofer-ignore></p><p>이와 같이 직접 레이블링이 가능하다. 좌측에 사각형 모양 위에 마우스 커서를 가져가면 class를 지정해줄 수 있고, share을 클릭하면 사각형을 그릴 수 있게 된다. 객체에 맞게 그려주고, <code class="language-plaintext highlighter-rouge">N</code>키를 누르면 다시 사각형 그리기가 가능하다. 그려진 박스에 우클릭하면 클래스를 변경해줄 수 있고, 우측 하단에 appearance에 보면 opacity, 즉 사각형의 투명도를 의미하고, 그 밑에 selected opacity는 마우스 커서를 박스 위로 가져갔을 때의 투명도를 의미한다. 상단에 <code class="language-plaintext highlighter-rouge">&gt;</code>를 누르거나 <code class="language-plaintext highlighter-rouge">F</code>키를 누르면 다음 이미지로 가고, <code class="language-plaintext highlighter-rouge">&lt;</code>를 누르거나 <code class="language-plaintext highlighter-rouge">G</code>키를 누르면 이전 이미지로 이동이 가능하다.</p><p><br /></p><p>완료한 후 save를 누르고, export task에서 label format을 지정해준다. 그 후 상단의 task로 이동하고, object detection task를 open해보면 방금 작업했던 job의 state가 in progress라고 되어 있다. 이는 아직 우리가 끝내고 나오지 않았기 때문이다.</p><p><img data-src="/assets/img/dev/week12/day3/inprogress.png" data-proofer-ignore></p><p><br /></p><p>다시 job을 들어가서 <code class="language-plaintext highlighter-rouge">finish the job</code>을 클릭해준다.</p><p><img data-src="/assets/img/dev/week12/day3/finishjob.png" data-proofer-ignore></p><p><br /></p><p>그러면 job이 completed되었다고 나온다.</p><p><img data-src="/assets/img/dev/week12/day3/completed.png" data-proofer-ignore></p><p>또는 finish the job 위에 change job state가 있다. 이를 통해 현재 상태를 변경해줄 수 있다.</p><p><br /></p><p>추가적으로 review모드를 통해 잘못된 레이블링은 잘못되었다고 설정해줄 수 있다.</p><p><img data-src="/assets/img/dev/week12/day3/review.png" data-proofer-ignore></p><p><br /></p><p>tasks 탭으로 이동하여 보게 되면 얼마나 진행되었는지 확인이 가능하다.</p><p><img data-src="/assets/img/dev/week12/day3/2by1finish.png" data-proofer-ignore></p><p><br /></p><p><br /></p><p>이제 sementation을 진행해보자. segmentation의 경우 1픽셀에 대한 값들을 레이블링해야 하므로 매우 정교해야 한다. 이 때는 사각형 밑에 polygon을 사용하여 점을 일일이 다 찍어줘야 한다. free space 즉 이동 가능한 공간을 칠해준다.</p><p><img data-src="/assets/img/dev/week12/day3/segment.png" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">alt</code>키를 누르면서 점을 클릭하면 삭제, <code class="language-plaintext highlighter-rouge">shift</code>키를 누르면서 점을 클릭하면 추가 점인데, 이것은 계속 누르고 있으면 연속적인 점을 찍게 되므로 조심히 클릭한 후 마우스 좌클릭으로 점을 찍어줘야 한다. 점을 드래그하면 점을 이동시킬 수 있다.</p><p>cvat에서는 이미지 밖에 좌표를 찍어도 이미지 안으로 옮겨진다.</p><p>cityscape format으로 추출한 뒤 colo.png를 보게 되면 다음과 같이 생성된 것을 볼 수 있다.</p><p><img data-src="/assets/img/dev/week12/day3/color.png" data-proofer-ignore></p><p><br /></p><p><br /></p><h1 id="data-augmentation">Data Augmentation</h1><p>색상, 기하학적 형태 등을 변형하는 것을 data augmentation이라 하는데, 객체에 대해서는 색상을 변형해도 문제가 되지 않을 수 있으나, 신호등에 대해 색상을 변형한다면 정보가 틀려지게 되는 것이므로 문제가 발생할 수 있다.</p><p>augmentation에 사용되는 라이브러리는 imgaug(https://github.com/aleju/imgaug), albumentations(https://albumentations.ai) 등이 있지만, 대표적으로 이 두가지를 많이 사용한다. albumentations가 조금 더 전문적인데, pytorch와 잘 연동이 되어 있어 pytorch를 사용한다면 후자를 사용하는 것을 추천한다.</p><p>이 글에서는 albumentations를 사용할 것이고, imgaug에 대해서는 <a href="https://dkssud8150.github.io/posts/yolo/">지난 블로그</a>를 참고하는 것이 좋을 것 같다.</p><p><br /></p><p><br /></p><h2 id="albumentations-설치">Albumentations 설치 <a href="#albumentations-설치" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>github : https://github.com/albumentations-team/albumentations documentation : https://albumentations.ai/docs/</p><p><br /></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip <span class="nb">install</span> <span class="nt">-U</span> albumentations
</pre></table></code></div></div><p>openCV(opencv-python-headless, opencv-python) 등을 이미 설치했다면, 위의 코드 대신 아래 코드를 사용하는 것이 좋다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip <span class="nb">install</span> <span class="nt">-U</span> albumentations <span class="nt">--no-binary</span> qudida,albumentations
</pre></table></code></div></div><p>단순한 이미지 변환에 대해서는 documentation을 찾아보면 다 나오고, 가우시안블러, rotation, distortion 등등 다양하게 제공하고 있다. 따라서 여기서는 object detection, semgentation에 대해서만 다룰 것이다.</p><p><br /></p><h2 id="augmentation-for-object-detection">augmentation for object detection <a href="#augmentation-for-object-detection" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>https://albumentations.ai/docs/getting_started/bounding_boxes_augmentation/</p><p>albumentations는 pascal_voc, coco, yolo format과 albumentation이라는 파이썬 패키지를 지원한다.</p><p><img data-src="/assets/img/dev/week12/day3/bbox_formats.jpg" data-proofer-ignore></p><p>pascal_voc의 경우 [min_x, min_y, max_x, max_y] 의 bbox를 가지고 있고, coco format의 경우 [min_x, y_min, width, height]의 bbox label을 가지고 있다. albumentations는 normalized[min_x, min_y, max_x, max_y] 의 형태이고, yolo는 normalized[center_x, center_y, width, height]를 가지고 있다.</p><p><br /></p><p><br /></p><p>KITTI dataset format을 coco, yolo, pascal voc format으로 변환해보자.</p><ul><li>KITTI Dataset Format</ul><div class="table-wrapper"><table><thead><tr><th>Values<th>Name<th>Description<tbody><tr><td>1<td>type<td>Describes the type of object: ‘Car’, ‘Van’, ‘Truck’, ‘Pedestrian’, ‘Person_sitting’, ‘Cyclist’, ‘Tram’, ‘Misc’ or ‘DontCare’<tr><td>1<td>truncated<td>Float from 0 (non-truncated) to 1 (truncated), where truncated refers to the object leaving image boundaries<tr><td>1<td>occluded<td>Integer (0,1,2,3) indicating occlusion state: 0 = fully visible, 1 = partly occluded, 2 = largely occluded, 3 = unknown<tr><td>1<td>alpha<td>Observation angle of object, ranging [-pi..pi]<tr><td>4<td>bbox<td>2D bounding box of object in the image (0-based index): contains left, top, right, bottom pixel coordinates<tr><td>3<td>dimensions<td>3D object dimensions: height, width, length (in meters)<tr><td>3<td>location<td>3D object location x,y,z in camera coordinates (in meters)<tr><td>1<td>rotation_y<td>Rotation ry around Y-axis in camera coordinates [-pi..pi]<tr><td>1<td>score<td>Only for results: Float, indicating confidence in detection, needed for p/r curves, higher is better.</table></div><p><br /></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">sys</span>

<span class="kn">import</span> <span class="n">cv2</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">import</span> <span class="n">albumentations</span> <span class="k">as</span> <span class="n">A</span>
<span class="kn">import</span> <span class="n">albumentations.augmentations.bbox_utils</span> <span class="k">as</span> <span class="n">bbox_utils</span>

<span class="n">BOX_COLOR</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Red
</span><span class="n">TEXT_COLOR</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="c1"># White
</span>
<span class="k">def</span> <span class="nf">my_transform</span><span class="p">(</span><span class="nb">format</span> <span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="nc">Compose</span><span class="p">([</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">RandomCrop</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">image_width</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">//</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">image_height</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">//</span> <span class="mi">5</span><span class="p">),</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">HorizontalFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">RandomBrightnessContrast</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.2</span><span class="p">),</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">CLAHE</span><span class="p">(),</span>          <span class="c1"># Contrast Limited Adaptive Histogram Equalization, 
</span>                            <span class="c1"># clip_limit : upper threshold for contrast, tile_grid_size : size of grid for histogram equalization
</span>        <span class="n">A</span><span class="p">.</span><span class="nc">RandomRotate90</span><span class="p">(),</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">ShiftScaleRotate</span><span class="p">(</span><span class="n">shift_limit</span><span class="o">=</span><span class="mf">0.0625</span><span class="p">,</span> <span class="n">scale_limit</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span> <span class="n">rotate_limit</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">.</span><span class="mi">75</span><span class="p">),</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">Blur</span><span class="p">(</span><span class="n">blur_limit</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">HueSaturationValue</span><span class="p">(),</span> <span class="c1"># randomly change hue, saturation
</span>        <span class="n">A</span><span class="p">.</span><span class="nc">GaussNoise</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="p">],</span> <span class="n">bbox_params</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="nc">BboxParams</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">label_fields</span><span class="o">=</span><span class="p">[</span><span class="s">'category_ids'</span><span class="p">]))</span> <span class="c1"># label_fields : class numbers e.g. 0,1,2,3,...,8
</span>                                                                                <span class="c1"># class_labels : class name list = category_id_to_name
</span>    <span class="k">return</span> <span class="n">transform</span>


<span class="k">def</span> <span class="nf">visualize_bbox</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">BOX_COLOR</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                        <span class="n">coco</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">yolo</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">pascal</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="s">"""Visualizes a single bounding box on the image"""</span>
    <span class="k">if</span> <span class="n">coco</span><span class="p">:</span>
        <span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">bbox</span>
        <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">x_min</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="n">x_min</span> <span class="o">+</span> <span class="n">w</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="n">y_min</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="n">y_min</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">yolo</span><span class="p">:</span>
        <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">bbox</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"img shape"</span><span class="p">,</span><span class="n">img</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">bbox shape"</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
        <span class="n">cx</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">img</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">w</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">img</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># unpack normalize
</span>        <span class="n">cy</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">img</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">h</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">img</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">cx</span> <span class="o">-</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="n">cx</span> <span class="o">+</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="n">cy</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pascal</span><span class="p">:</span>
        <span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">bbox</span><span class="p">))</span>

    <span class="nf">print</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">y_max</span><span class="p">)</span>      
   
    <span class="n">cv2</span><span class="p">.</span><span class="nf">rectangle</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span><span class="p">),</span> <span class="p">(</span><span class="n">x_max</span><span class="p">,</span> <span class="n">y_max</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
    
    <span class="p">((</span><span class="n">text_width</span><span class="p">,</span> <span class="n">text_height</span><span class="p">),</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">getTextSize</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cv2</span><span class="p">.</span><span class="nf">rectangle</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span> <span class="o">-</span> <span class="nf">int</span><span class="p">(</span><span class="mf">1.3</span> <span class="o">*</span> <span class="n">text_height</span><span class="p">)),</span> <span class="p">(</span><span class="n">x_min</span> <span class="o">+</span> <span class="n">text_width</span><span class="p">,</span> <span class="n">y_min</span><span class="p">),</span> <span class="n">BOX_COLOR</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cv2</span><span class="p">.</span><span class="nf">putText</span><span class="p">(</span>
            <span class="n">img</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="n">class_name</span><span class="p">,</span>
            <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span> <span class="o">-</span> <span class="nf">int</span><span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">text_height</span><span class="p">)),</span>
            <span class="n">fontFace</span><span class="o">=</span><span class="n">cv2</span><span class="p">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span>
            <span class="n">fontScale</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="n">TEXT_COLOR</span><span class="p">,</span> 
            <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="p">.</span><span class="n">LINE_AA</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">img</span>

<span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">bboxes</span><span class="p">,</span> <span class="n">category_ids</span><span class="p">,</span> <span class="n">category_id_to_name</span><span class="p">):</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">category_id</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">category_ids</span><span class="p">):</span>
        <span class="n">class_name</span> <span class="o">=</span> <span class="n">category_id_to_name</span><span class="p">[</span><span class="n">category_id</span><span class="p">]</span>
        <span class="n">img</span> <span class="o">=</span> <span class="nf">visualize_bbox</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">yolo</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="s">'off'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">imread</span><span class="p">(</span><span class="s">"./od/image.png"</span><span class="p">)</span>

<span class="c1"># cv2.imshow("TEST", image)
# cv2.waitKey(0)
</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>

<span class="n">CLASS_TABLE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"Car"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s">"Van"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">"Truck"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s">"Pedestrian"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s">"Person_sitting"</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s">"Cyclist"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s">"Tram"</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s">"Misc"</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s">"DontCare"</span><span class="p">:</span> <span class="mi">8</span>
<span class="p">}</span>

<span class="n">image_size</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">image_height</span> <span class="o">=</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">image_width</span> <span class="o">=</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">category_id_to_name</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">CLASS_TABLE</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
    <span class="n">category_id_to_name</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

<span class="c1"># TODO YOLO Parse
</span><span class="n">bboxes</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>
<span class="n">category_ids</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="s">"od/label.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">od_label</span><span class="p">:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">od_label</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>

<span class="s">""" COCO Dataset Format
[x_min y_min width height]
"""</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
    <span class="n">class_id</span> <span class="o">=</span> <span class="n">CLASS_TABLE</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">left</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">top</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    <span class="n">right</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>

    <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">=</span> <span class="n">bbox_utils</span><span class="p">.</span><span class="nf">normalize_bbox</span><span class="p">((</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="n">image_height</span><span class="p">,</span> <span class="n">image_width</span><span class="p">)</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">left</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">bottom</span> <span class="o">-</span> <span class="n">top</span>

    <span class="n">bboxes</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">left</span><span class="o">+</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
    <span class="n">category_ids</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">class_id</span><span class="p">)</span>

<span class="n">transform</span> <span class="o">=</span> <span class="nf">my_transform</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s">"yolo"</span><span class="p">)</span>
<span class="n">transformed</span> <span class="o">=</span> <span class="nf">transform</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">bboxes</span><span class="o">=</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">category_ids</span><span class="o">=</span><span class="n">category_ids</span><span class="p">)</span>
<span class="n">transformed_image</span> <span class="o">=</span> <span class="n">transformed</span><span class="p">[</span><span class="s">'image'</span><span class="p">]</span>
<span class="n">transformed_bboxes</span> <span class="o">=</span> <span class="n">transformed</span><span class="p">[</span><span class="s">'bboxes'</span><span class="p">]</span>


<span class="nf">visualize</span><span class="p">(</span><span class="n">transformed_image</span><span class="p">,</span> <span class="n">transformed_bboxes</span><span class="p">,</span> <span class="n">category_ids</span><span class="p">,</span> <span class="n">category_id_to_name</span><span class="p">)</span>
</pre></table></code></div></div><p>albumentations에는 yolo, coco, pascal format을 지원하므로 이에 대해 my_transform에서의 format과 visualize에서의 visualize_bbox의 인자로 어떤 format을 사용할지만 지정해주면 변환이 가능하다. 그러나 yolo의 경우 transform을 할 때 normalize된 bbox를 가져야 하기 때문에 변형시켜줘야 한다. normalize를 해주고, yolo의 경우 (0, 1] 의 범위를 가져야 한다. 따라서 0.0에서 작은 값인 1e-5를 더해준다.</p><p><br /></p><h2 id="augmentation-for-segmentation">augmentation for segmentation <a href="#augmentation-for-segmentation" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">cv2</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">import</span> <span class="n">albumentations</span> <span class="k">as</span> <span class="n">A</span>

<span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">original_image</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">original_mask</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span>
    
    <span class="k">if</span> <span class="n">original_image</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">original_mask</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">].</span><span class="nf">imshow</span><span class="p">(</span><span class="n">original_image</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'Original image'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">].</span><span class="nf">imshow</span><span class="p">(</span><span class="n">original_mask</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'Original mask'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">].</span><span class="nf">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'Transformed image'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">].</span><span class="nf">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'Transformed mask'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="c1"># Read image, mask
</span><span class="k">def</span> <span class="nf">read_image</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">imread</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">IMREAD_ANYCOLOR</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">image</span>

<span class="n">image</span> <span class="o">=</span> <span class="nf">read_image</span><span class="p">(</span><span class="s">"seg/image.png"</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="nf">read_image</span><span class="p">(</span><span class="s">"seg/mask.png"</span><span class="p">)</span>

<span class="n">original_height</span><span class="p">,</span> <span class="n">original_width</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Augmentation
</span><span class="n">aug</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="nc">Compose</span><span class="p">([</span>
    <span class="n">A</span><span class="p">.</span><span class="nc">OneOf</span><span class="p">([</span> <span class="c1"># choose only one randomly
</span>        <span class="n">A</span><span class="p">.</span><span class="nc">RandomSizedCrop</span><span class="p">(</span><span class="n">min_max_height</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">101</span><span class="p">),</span> <span class="n">height</span><span class="o">=</span><span class="n">original_height</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">original_width</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">PadIfNeeded</span><span class="p">(</span><span class="n">min_height</span><span class="o">=</span><span class="n">original_height</span><span class="p">,</span> <span class="n">min_width</span><span class="o">=</span><span class="n">original_width</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>    
    <span class="n">A</span><span class="p">.</span><span class="nc">VerticalFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>              
    <span class="n">A</span><span class="p">.</span><span class="nc">RandomRotate90</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="n">A</span><span class="p">.</span><span class="nc">OneOf</span><span class="p">([</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">ElasticTransform</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">120</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alpha_affine</span><span class="o">=</span><span class="mi">120</span> <span class="o">*</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">GridDistortion</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">A</span><span class="p">.</span><span class="nc">OpticalDistortion</span><span class="p">(</span><span class="n">distort_limit</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shift_limit</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                  
        <span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span>
    <span class="n">A</span><span class="p">.</span><span class="nc">CLAHE</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span>
    <span class="n">A</span><span class="p">.</span><span class="nc">RandomBrightnessContrast</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span>    
    <span class="n">A</span><span class="p">.</span><span class="nc">RandomGamma</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)])</span>
    
<span class="n">augmented</span> <span class="o">=</span> <span class="nf">aug</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
<span class="n">image_heavy</span> <span class="o">=</span> <span class="n">augmented</span><span class="p">[</span><span class="s">'image'</span><span class="p">]</span>
<span class="n">mask_heavy</span> <span class="o">=</span> <span class="n">augmented</span><span class="p">[</span><span class="s">'mask'</span><span class="p">]</span>

<span class="nf">visualize</span><span class="p">(</span><span class="n">image_heavy</span><span class="p">,</span> <span class="n">mask_heavy</span><span class="p">,</span> <span class="n">original_image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">original_mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">oneof</code> 는 저 리스트 중 랜덤으로 1개만을 사용하겠다는 의미이다.</p></div><div class="post-tail-wrapper text-muted"><div style="text-align: left;"> <a href="http://hits.dwyl.com/dkssud8150.github.io/posts/labeling/" target="_blank"> <img data-src="http://hits.dwyl.com/dkssud8150.github.io/posts/labeling.svg" data-proofer-ignore> </a></div><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/classlog/'>Classlog</a>, <a href='/categories/devcourse/'>devcourse</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/devcourse/" class="post-tag no-text-decoration" >devcourse</a> <a href="/tags/deeplearning/" class="post-tag no-text-decoration" >deeplearning</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[데브코스] 12주차 - DeepLearning Data Labeling and Data Augmentation - JaeHo Yoon&amp;url=https://dkssud8150.github.io/posts/labeling/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[데브코스] 12주차 - DeepLearning Data Labeling and Data Augmentation - JaeHo Yoon&amp;u=https://dkssud8150.github.io/posts/labeling/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://dkssud8150.github.io/posts/labeling/&amp;text=[데브코스] 12주차 - DeepLearning Data Labeling and Data Augmentation - JaeHo Yoon" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://dkssud8150.github.io/posts/labeling/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6611243953442169" crossorigin="anonymous"></script></div><script src="https://utteranc.es/client.js" repo="dkssud8150/dkssud8150.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/gitpage/">[깃허브 프로필 꾸미기] github 프로필 만들기</a><li><a href="/posts/product/">[깃허브 프로필 꾸미기] productive box 만들기</a><li><a href="/posts/regex/">[데브코스] 2주차 - linux 기초(REGEX)</a><li><a href="/posts/Kfold/">KFold Cross Validation 과 StratifiedKFold</a><li><a href="/posts/cmake/">[데브코스] 17주차 - CMake OpenCV, Eigen, Pangolin install </a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/devcourse/">devcourse</a> <a class="post-tag" href="/tags/deeplearning/">deeplearning</a> <a class="post-tag" href="/tags/cs231n/">CS231N</a> <a class="post-tag" href="/tags/ros/">ros</a> <a class="post-tag" href="/tags/coding-test/">coding test</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/kooc/">kooc</a> <a class="post-tag" href="/tags/opencv/">OpenCV</a> <a class="post-tag" href="/tags/pytorch-tutorial/">pytorch tutorial</a> <a class="post-tag" href="/tags/autonomous-driving/">Autonomous Driving</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/numpy/"><div class="card-body"> <em class="timeago small" date="2022-04-11 14:40:00 +0900" >Apr 11, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[데브코스] 9주차 - DeepLearning Numpy & Matplotlib</h3><div class="text-muted small"><p> Numpy Numpy 설치 및 불러오기 pip install numpy import numpy as np 파이썬의 리스트는 머신러닝에서 가장 많이 사용되는 구조 중 하나일 것이다. 그러나 이 리스트는 연산 속도가 느리다. 그래서 연산을 효과적으로 할 수 있도록 하기 위해 만든 것이 Numpy이다. Numpy 연산 속도 nump...</p></div></div></a></div><div class="card"> <a href="/posts/dplearn/"><div class="card-body"> <em class="timeago small" date="2022-04-12 15:40:00 +0900" >Apr 12, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[데브코스] 9주차 - DeepLearning AI & machine learning</h3><div class="text-muted small"><p> 기계 학습 어떤 컴퓨터 프로그램이 T라는 작업을 수행할 때, 이 프로그램의 성능이 P라는 척도로 평가했을 때 경험 E를 통해 성능이 개선된다면 이 프로그램은 학습한다고 말할 수 있다. 따라서 최적의 알고리즘을 찾는 행위를 기계 학습이라 할 수 있다. 기계 학습의 중심은 경험, 과업, 성능에 있다. 예전에는 지식 기반의 학습을 했다. 즉, 인간이...</p></div></div></a></div><div class="card"> <a href="/posts/mlmath/"><div class="card-body"> <em class="timeago small" date="2022-04-13 15:40:00 +0900" >Apr 13, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[데브코스] 9주차 - DeepLearning Mathematics for Machine Learning</h3><div class="text-muted small"><p> 기계 학습에서 수학은 손실함수를 정의하고 손실함수의 최저점을 찾아주는 최적화 이론에 사용된다. 제어를 함에 있어서도 수학이 필요하다. 선형대수 데이터는 벡터나 행렬, 텐서 형태로 되어 있는데, 이에 대한 공간을 이해하고, 연산을 하기 위해서는 선형대수가 필요하다. 벡터와 행렬 벡터는 요소의 종료와 크기를 표현한다. [x \in R^n] ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/dataset/" class="btn btn-outline-primary" prompt="Older"><p>[데브코스] 12주차 - DeepLearning Open Dataset and Dataset label format Convert to Yolo format</p></a> <a href="/posts/perception/" class="btn btn-outline-primary" prompt="Newer"><p>[데브코스] 12주차 - DeepLearning Perception Applications</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">JaeHo YooN</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/devcourse/">devcourse</a> <a class="post-tag" href="/tags/deeplearning/">deeplearning</a> <a class="post-tag" href="/tags/cs231n/">CS231N</a> <a class="post-tag" href="/tags/ros/">ros</a> <a class="post-tag" href="/tags/coding-test/">coding test</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/kooc/">kooc</a> <a class="post-tag" href="/tags/opencv/">OpenCV</a> <a class="post-tag" href="/tags/pytorch-tutorial/">pytorch tutorial</a> <a class="post-tag" href="/tags/autonomous-driving/">Autonomous Driving</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-NC7MWHVXJE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NC7MWHVXJE'); }); </script>