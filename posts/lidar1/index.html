<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS nodes and topics for lidar sensors" /><meta name="author" content="JaeHo YooN" /><meta property="og:locale" content="en" /><meta name="description" content="Do focus on developing â€˜your abilityâ€™ rather than waste time on making you famous." /><meta property="og:description" content="Do focus on developing â€˜your abilityâ€™ rather than waste time on making you famous." /><link rel="canonical" href="https://dkssud8150.github.io/posts/lidar1/" /><meta property="og:url" content="https://dkssud8150.github.io/posts/lidar1/" /><meta property="og:site_name" content="JaeHo Yoon" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-10T16:14:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS nodes and topics for lidar sensors" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@JaeHo YooN" /><meta name="google-site-verification" content="znvuGsQGYxMZPBslC4XG6doCYao6Y-fWibfGlcaMHH8" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"JaeHo YooN"},"dateModified":"2022-07-29T05:41:26+09:00","datePublished":"2022-03-10T16:14:00+09:00","description":"Do focus on developing â€˜your abilityâ€™ rather than waste time on making you famous.","headline":"[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS nodes and topics for lidar sensors","mainEntityOfPage":{"@type":"WebPage","@id":"https://dkssud8150.github.io/posts/lidar1/"},"url":"https://dkssud8150.github.io/posts/lidar1/"}</script><title>[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS nodes and topics for lidar sensors | JaeHo Yoon</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="JaeHo Yoon"><meta name="application-name" content="JaeHo Yoon"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/shin_chan.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">JaeHo Yoon</a></div><div class="site-subtitle font-italic">Mamba Mentality</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fab fa-angellist ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/dkssud8150" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hoya58150','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.notion.so/18490713817d403696812c57d0abe730" aria-label="notion" target="_blank" rel="noopener"> <i class="fab fa-battle-net"></i> </a> <a href="https://www.linkedin.com/in/jaeho-yoon-90b62b230" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.instagram.com/jai_ho8150/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS nodes and topics for lidar sensors </span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 500'%3E%3C/svg%3E" data-src="/assets/img/dev/week4/day3/lidar.jpeg" class="preview-img bg" alt="Preview Image" width="800" height="500" data-proofer-ignore><h1 data-toc-skip>[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS nodes and topics for lidar sensors</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/dkssud8150">JaeHo YooN</a> </em></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6611243953442169" crossorigin="anonymous"></script><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-03-10 16:14:00 +0900" data-toggle="tooltip" data-placement="bottom" title="Thu, Mar 10, 2022, 4:14 PM +0900" >Mar 10, 2022</em> </span> <span> Updated <em class="timeago" date="2022-07-29 05:41:26 +0900 " data-toggle="tooltip" data-placement="bottom" title="Fri, Jul 29, 2022, 5:41 AM +0900" >Jul 29, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5978 words"> <em>33 min</em> read</span></div></div></div><div class="post-content"><p><br /></p><h1 id="ë¼ì´ë‹¤-ì„¼ì„œ-ros-íŒ¨í‚¤ì§€">ë¼ì´ë‹¤ ì„¼ì„œ ROS íŒ¨í‚¤ì§€</h1><p>ë¼ì´ë‹¤ ì„¼ì„œ ROS íŒ¨í‚¤ì§€ë¥¼ xycar_lidarë¡œ ë§Œë“ ë‹¤. í† í”½ì˜ ì´ë¦„ì€ <code class="language-plaintext highlighter-rouge">/scan</code>ìœ¼ë¡œ í•  ê²ƒì´ë‹¤.</p><p><code class="language-plaintext highlighter-rouge">/scan</code> í† í”½ì•ˆì—ëŠ”</p><ul><li>íƒ€ì… : sensor_msgs\/LaserScan<li>êµ¬ì„±<ul><li>std_msgs/Header header # ì‹œí€€ìŠ¤ ë²ˆí˜¸, ì‹œê°„, ì•„ì´ë””ë¥¼ ë‹´ëŠ”ë‹¤. uid32 seq time stamp string frame_id # rvizì— ì‚¬ìš©ë˜ëŠ” ê°’ float32 angle_min float32 angle_max â€¦ float32[] ranges # ì¥ì• ë¬¼ê¹Œì§€ì˜ ê±°ë¦¬ ì •ë³´ë“¤ì„ ë‹´ëŠ” array float32[] intensities # ë¬¼ì²´ì˜ ê²½ë„</ul></ul><p><br /></p><h2 id="ë¼ì´ë‹¤-ê±°ë¦¬-ì •ë³´-í™”ë©´ì—-ì¶œë ¥">ë¼ì´ë‹¤ ê±°ë¦¬ ì •ë³´ í™”ë©´ì— ì¶œë ¥ <a href="#ë¼ì´ë‹¤-ê±°ë¦¬-ì •ë³´-í™”ë©´ì—-ì¶œë ¥" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="íŒ¨í‚¤ì§€-ë§Œë“¤ê¸°">íŒ¨í‚¤ì§€ ë§Œë“¤ê¸° <a href="#íŒ¨í‚¤ì§€-ë§Œë“¤ê¸°" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-markdown highlighter-rouge"><div class="code-header"> <span data-label-text="Markdown"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>xycar_ws
  âŠ¢ build
  âŠ¢ devel
  âˆŸ src
      âˆŸ my_lidar
          âŠ¢ launch
              âˆŸ lidar_scan.launch
          âˆŸ src
              âˆŸ lidar_scan.py
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>xycar_ws/src<span class="nv">$ </span>catkin_create_pkg my_lidar std_msgs rospy
</pre></table></code></div></div><h3 id="ì„œë¸Œ-í´ë”-ë§Œë“¤ê¸°">ì„œë¸Œ í´ë” ë§Œë“¤ê¸° <a href="#ì„œë¸Œ-í´ë”-ë§Œë“¤ê¸°" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>launch íŒŒì¼ ìƒì„±</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">mkdir </span>launch
<span class="nv">$ </span>gedit lidar_scan.launch
</pre></table></code></div></div><h3 id="ì†ŒìŠ¤íŒŒì¼-ë§Œë“¤ê¸°">ì†ŒìŠ¤íŒŒì¼ ë§Œë“¤ê¸° <a href="#ì†ŒìŠ¤íŒŒì¼-ë§Œë“¤ê¸°" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>ë¼ì´ë‹¤ë¡œë¶€í„° ì£¼ë³€ ë¬¼ì²´ê¹Œì§€ì˜ ê±°ë¦¬ê°’ì„ ë°›ì•„ ì¶œë ¥í•œë‹¤.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="c1"># lidar_scan.py
</span>
<span class="kn">import</span> <span class="n">rospy</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="n">sensor_msgs.msg</span> <span class="kn">import</span> <span class="n">LaserScan</span> <span class="c1"># LaserScan ë©”ì‹œì§€ ì‚¬ìš© ì¤€ë¹„
</span>
<span class="n">lidar_points</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c1"># ë¼ì´ë‹¤ í† í”½ì´ ë“¤ì–´ì˜¤ë©´ ì‹¤í–‰ë˜ëŠ” ì½œë°± í•¨ìˆ˜
</span><span class="k">def</span> <span class="nf">lidar_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">lidar_points</span> 
    <span class="n">lidar_points</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">ranges</span>

<span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="s">'my_lidar'</span><span class="p">,</span> <span class="n">anonymous</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># lidar ì´ë¦„ì˜ ë…¸ë“œ ìƒì„±
</span><span class="n">rospy</span><span class="p">.</span><span class="nc">Subscriber</span><span class="p">(</span><span class="s">'/scan'</span><span class="p">,</span> <span class="n">LaserScan</span><span class="p">,</span> <span class="n">lidar_callback</span><span class="p">,</span> <span class="n">queue_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># laserscan í† í”½ì´ ì˜¤ë©´ ì½œë°±í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë„ë¡ ì…‹íŒ…
</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="p">.</span><span class="nf">is_shutdown</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">lidar_points</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">continue</span>    <span class="c1"># í† í”½ì´ ì•ˆì™”ìœ¼ë©´ ê¸°ë‹¤ë ¤ë¼
</span>
    <span class="n">rtn</span> <span class="o">=</span> <span class="s">''</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span> <span class="c1"># 30ë„ì”© ê±´ë„ˆë›°ë©´ì„œ 12ê°œ ê±°ë¦¬ê°’ë§Œ ì¶œë ¥
</span>        <span class="n">rtn</span> <span class="o">+=</span> <span class="nf">str</span><span class="p">(</span><span class="nf">format</span><span class="p">(</span><span class="n">lidar_points</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">30</span><span class="p">],</span><span class="s">'.2f'</span><span class="p">))</span> <span class="o">+</span> <span class="s">", "</span>

    <span class="nf">print</span><span class="p">(</span><span class="n">rtn</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># ì²œì²œíˆ ì¶œë ¥
</span></pre></table></code></div></div><ul><li>launch íŒŒì¼ ìƒì„±</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- lidar_scan.launch --&gt;</span>
<span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">"$(find xycar_lidar)/launch/lidar_noviewer.launch"</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- ë¼ì´ë‹¤ ì¥ì¹˜ë¥¼ êµ¬ë™ì‹œì¼œ í† í”½ì„ ë°œí–‰í•˜ëŠ” íŒŒì¼ --&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"my lidar"</span> <span class="na">pkg=</span><span class="s">"my_liad"</span> <span class="na">type=</span><span class="s">"lidar_scan.py"</span> <span class="na">output=</span><span class="s">'screen'</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></table></code></div></div><h3 id="ì‹¤í–‰">ì‹¤í–‰ <a href="#ì‹¤í–‰" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>roslaunch my_lidar lidar_scan.launch
</pre></table></code></div></div><p>ì¶œë ¥ì—ì„œ infëŠ” ë¬´í•œëŒ€ë¡œ ë„ˆë¬´ ë©€ê±°ë‚˜ ë„ˆë¬´ ê°€ê¹ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì¶œë ¥ëœ ì •ë³´ëŠ” ê±°ë¦¬ë¡œ më‹¨ìœ„ì´ë‹¤. ì½”ë“œë¥¼ ì§¤ ë•Œ infì™€ ê°™ì´ ì˜¤ë¥˜ê°€ ë‚˜ëŠ” ê²ƒì— ëŒ€í•´ì„œ ì˜ ì²˜ë¦¬í•´ì•¼ ì˜¤ë¥˜ê°€ ë‚˜ì§€ ì•Šê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p><p><br /></p><h2 id="ì¶œë ¥-ì‹œê°í™”í•˜ê¸°">ì¶œë ¥ ì‹œê°í™”í•˜ê¸° <a href="#ì¶œë ¥-ì‹œê°í™”í•˜ê¸°" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="íŒ¨í‚¤ì§€-ìƒì„±">íŒ¨í‚¤ì§€ ìƒì„± <a href="#íŒ¨í‚¤ì§€-ìƒì„±" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>xycar_ws
  âŠ¢ build
  âŠ¢ devel
  âˆŸ src
      âˆŸ rviz_lidar
          âŠ¢ launch
              âˆŸ lidar_3d.launch
          âŠ¢ src
          âˆŸ rviz
              âˆŸ lidar_3d.rviz
</pre></table></code></div></div><p>rviz_lidarë¼ëŠ” ì´ë¦„ì˜ ROS íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•œë‹¤.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>catkin_create_pkg rivz_lidar rospy tf geometry_msgs urdf rviz xacro
</pre></table></code></div></div><h3 id="ì„œë¸Œ-í´ë”-ìƒì„±">ì„œë¸Œ í´ë” ìƒì„± <a href="#ì„œë¸Œ-í´ë”-ìƒì„±" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>launch í´ë” ë§Œë“¤ê¸°<ul><li>lidar_3d.launch ìƒì„±</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>  <span class="nt">&lt;launch&gt;</span>
      <span class="c">&lt;!-- rviz display --&gt;</span>
      <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"rviz_visualizer"</span> <span class="na">pkg=</span><span class="s">"rviz"</span> <span class="na">type=</span><span class="s">"rviz"</span> <span class="na">required=</span><span class="s">"true"</span>
      <span class="na">args=</span><span class="s">"-d $(find rviz_lidar)/rviz/lidar_3d.rviz"</span><span class="nt">/&gt;</span>

      <span class="c">&lt;!-- c++ íŒŒì¼ì„ ì‹¤í–‰ --&gt;</span>
      <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"xycar_lidar"</span> <span class="na">pkg=</span><span class="s">"xycar_lidar"</span> <span class="na">type=</span><span class="s">"xycar_lidar"</span> <span class="na">output=</span><span class="s">"screen"</span> <span class="nt">&gt;</span>
          <span class="c">&lt;!-- í¬íŠ¸ --&gt;</span>
          <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"serial_port"</span>   <span class="na">xype=</span><span class="s">"string"</span>   <span class="na">value=</span><span class="s">"/dev/ttyRPL"</span><span class="nt">/&gt;</span>
          <span class="c">&lt;!-- usbì´ì§€ë§Œ serialíŒŒì¼ë¡œ ëŒì•„ê°„ë‹¤. --&gt;</span>
          <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"serial_baudrate"</span>   <span class="na">xype=</span><span class="s">"int"</span>   <span class="na">value=</span><span class="s">"115200"</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"frame_id"</span>   <span class="na">xype=</span><span class="s">"string"</span>   <span class="na">value=</span><span class="s">"laser"</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"inverterd"</span>   <span class="na">xype=</span><span class="s">"bool"</span>   <span class="na">value=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"angle_compensate"</span>   <span class="na">xype=</span><span class="s">"bool"</span>   <span class="na">value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/node&gt;</span>
  <span class="nt">&lt;/launch&gt;</span>
</pre></table></code></div></div></ul><h3 id="-ë¼ì´ë‹¤-ì¥ì¹˜ê°€-ì—†ì„-ê²½ìš°">+ ë¼ì´ë‹¤ ì¥ì¹˜ê°€ ì—†ì„ ê²½ìš° <a href="#-ë¼ì´ë‹¤-ì¥ì¹˜ê°€-ì—†ì„-ê²½ìš°" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>ê·¸ëŸ¬ë‚˜ ë¼ì´ë‹¤ ì¥ì¹˜ê°€ ì—†ì„ ê²½ìš°ì—ëŠ” ì´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì„ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì‹¤ì œ ë¼ì´ë‹¤ ì¥ì¹˜ë¥¼ ëŒ€ì‹ í•˜ì—¬ /scan í† í”½ì„ ë°œí–‰í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì´ìš©í•  ìˆ˜ ìˆë‹¤.</p><p>ROSì—ì„œ ì œê³µí•˜ëŠ” <strong>rosbag</strong>ë¥¼ ì´ìš©í•˜ë©´ ëœë‹¤. ì´ëŠ” ë¼ì´ë‹¤ì—ì„œ ë°œí–‰í•˜ëŠ” scan í† í”½ì„ ì €ì¥í•´ë†“ì€ íŒŒì¼ë¡œ, ê·¸ ë‹¹ì‹œì˜ ì‹œê°„ ê°„ê²©ì— ë§ì¶”ì–´ scan í† í”½ì„ ë°œí–‰í•  ìˆ˜ ìˆë‹¤.</p><p><br /></p><p>ì´ rosbagì„ ì‚¬ìš©í•  ê²½ìš° launchíŒŒì¼ì„ ì‚´ì§ ìˆ˜ì •í•´ì•¼ í•œë‹¤.</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- lidar_3d_rosbag.launch --&gt;</span>
<span class="nt">&lt;launch&gt;</span>
    <span class="c">&lt;!-- rviz display --&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"rviz_visualizer"</span> <span class="na">pkg=</span><span class="s">"rviz"</span> <span class="na">type=</span><span class="s">"rviz"</span> <span class="na">required=</span><span class="s">"true"</span>
    <span class="na">args=</span><span class="s">"-d $(find rviz_lidar)/rviz/lidar_3d.rviz"</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- c++ íŒŒì¼ì„ ì‹¤í–‰ --&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"rosbag_play"</span> <span class="na">pkg=</span><span class="s">"rosbag"</span> <span class="na">type=</span><span class="s">"play"</span> <span class="na">output=</span><span class="s">"screen"</span> 
        <span class="na">required=</span><span class="s">"true"</span> <span class="na">args=</span><span class="s">"$(find rviz_lidar)/src/lidar_topic.bag"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></table></code></div></div><p>ë” ìì„¸í•œ ê±´ ì•„ë˜ì—ì„œ ë‹¤ë£¨ê² ë‹¤.</p><p><br /></p><h3 id="ì‹¤í–‰-1">ì‹¤í–‰ <a href="#ì‹¤í–‰-1" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>ë¨¼ì € ë¼ì´ë‹¤ê°€ ìˆëŠ” ê²½ìš°ë¥¼ ì‚´í´ë³´ì.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>roslaunch rviz_lidar lidar_3d.launch
</pre></table></code></div></div><p>ì‹¤í–‰ì„ í•´ë„ ì•„ì§ ì•„ë¬´ê²ƒë„ ì•ˆë‚˜ì˜¨ë‹¤. í”ŒëŸ¬ê·¸ì¸ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤.</p><ol><li>í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€<ul><li>ìš°ì¸¡ displays íƒ­ í•˜ë‹¨ì— addí´ë¦­<li>laserscan ì„ íƒ í›„ okí´ë¦­</ul><li>topic ì„¤ì •<ul><li>laserscan ì—ì„œ topicì„ <code class="language-plaintext highlighter-rouge">/scan</code>ìœ¼ë¡œ ì‘ì„±í•˜ê±°ë‚˜ í™”ì‚´í‘œë¥¼ ëˆŒëŸ¬ ì„ íƒ</ul><li>fixed frame<ul><li>displays íƒ­ì—ì„œ fixed frameì„ laserë¡œ ìˆ˜ì •<li>ì´ëŠ” header - frame_id ì— í•´ë‹¹í•˜ëŠ” ê°’ì„</ul><li>size ì„¤ì •<ul><li>laserscanì—ì„œ sizeë¥¼ ì„¤ì •í•´ì•¼ í•œë‹¤. 0.1 ì •ë„ë¡œ í•˜ë©´ í™”ë©´ì— ì˜ ë³´ì¼ ê²ƒì´ë‹¤.<li>ë„ˆë¬´ ì‘ìœ¼ë©´ ì‚¬ì´ì¦ˆë¥¼ í‚¤ìš°ë©´ ëœë‹¤.</ul></ol><p><br /></p><p><br /></p><h2 id="rosbag">ROSBAG <a href="#rosbag" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="http://wiki.ros.org/rosbag">ros ê³µì‹ ë¬¸ì„œ - rosbag</a></p><p>ROSBAG : ROS ëª…ë ¹ì–´ë¡œ í† í”½ì„ êµ¬ë…í•˜ì—¬ íŒŒì¼ë¡œ ì €ì¥í•˜ê±°ë‚˜íŒŒì¼ì—ì„œ í† í”½ì„ êº¼ë‚´ ë°œí–‰í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.</p><p>í† í”½ì˜ ë‚´ìš©ë§Œ ì‘ì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì‹œê°„ë„ í•¨ê»˜ ë‹´ì•„ì„œ êº¼ë‚¼ ë•ŒëŠ” ì‹œê°„ë„ í•¨ê»˜ ë°›ì„ ìˆ˜ ìˆë‹¤.</p><h3 id="ì‚¬ìš©ë²•">ì‚¬ìš©ë²• <a href="#ì‚¬ìš©ë²•" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>ì €ì¥
<span class="nv">$ </span>rosbag record <span class="nt">-O</span> lidar_topic scan

ë¶ˆëŸ¬ì˜¤ê¸°
<span class="nv">$ </span>rosbag play lidar_topic.bag 
</pre></table></code></div></div><p>lidar_topicì€ ì €ì¥í•  íŒŒì¼ì˜ ì´ë¦„ì´ê³ , scanì€ êµ¬ë…í•´ì„œ ì €ì¥í•  í† í”½ì˜ ì´ë¦„ì´ë‹¤. í† í”½ì€ ì—¬ëŸ¬ê°œë¡œ ì‘ì„± ê°€ëŠ¥í•˜ë‹¤.</p><p><br /></p><ul><li>ëŸ°ì¹˜íŒŒì¼ì—ì„œ ì‹¤í–‰</ul><p>nodeë¥¼ ì„ ì–¸í•  ê²ƒì´ë‹¤.</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"rosbag_play"</span> <span class="na">pkg=</span><span class="s">"rosbag"</span> <span class="na">type=</span><span class="s">"play"</span> <span class="na">output=</span><span class="s">"screen"</span>
        <span class="na">required=</span><span class="s">"true"</span> <span class="na">args=</span><span class="s">"$(find rviz_lidar)/src/liar_topic.bag"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></table></code></div></div><p><br /></p><p><br /></p><h2 id="range-ë°ì´í„°ë¥¼-ë°œí–‰í•´ì„œ-ë·°ì–´ì—-í‘œì‹œí•´ë³´ê¸°">range ë°ì´í„°ë¥¼ ë°œí–‰í•´ì„œ ë·°ì–´ì— í‘œì‹œí•´ë³´ê¸° <a href="#range-ë°ì´í„°ë¥¼-ë°œí–‰í•´ì„œ-ë·°ì–´ì—-í‘œì‹œí•´ë³´ê¸°" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>rangeë°ì´í„°ë¥¼ ë‹´ì€ í† í”½ì„ ë°œí–‰í•˜ëŠ” <code class="language-plaintext highlighter-rouge">lidar_range.py</code>ë¥¼ ë§Œë“¤ì–´ì„œ <code class="language-plaintext highlighter-rouge">/scan1</code> ì´ë¦„ì˜ í† í”½ì„ ë°œí–‰í•œë‹¤.</p><p>rangeíƒ€ì…ì˜ ë°ì´í„°ë¥¼ ë‹´ì€ /scan1 /scan2 /scan3 /scan4 ì´ 4ê°œ í† í”½ì„ ë°œí–‰í•œë‹¤. RVIZì—ì„œëŠ” ì›ë¿” ê·¸ë¦¼ì˜ Range ê±°ë¦¬ì •ë³´ë¥¼ ì‹œê°í™”í•˜ì—¬ í‘œì‹œí•œë‹¤.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>xycar_ws
  âŠ¢ build
  âŠ¢ devel
  âˆŸ src
      âˆŸ rviz_lidar
          âŠ¢ launch
              âˆŸ lidar_range.launch
          âŠ¢ src
              âˆŸ lidar_range.py
          âˆŸ rviz
              âˆŸ lidar_range.rviz
</pre></table></code></div></div><p>ê¸°ì¡´ì˜ rviz_lidaríŒŒì¼ì—ì„œ ì§„í–‰í•  ê²ƒì´ê³ , ì—°ê²° ê´€ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p><p><img data-src="/assets/img/dev/week4/day4/rosbag_con.png" data-proofer-ignore></p><ul><li>ë…¸ë“œ ì´ë¦„: lindar_range<li>í† í”½ ì´ë¦„: /scan1~4<li>ë©”ì‹œì§€ íƒ€ì…: range (from sensor_msgs.msg import Range)</ul><p>publish ë…¸ë“œ</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>pub1 = rospy.Publisher('scan1',Range,queue_size=1)
pub2 = rospy.Publisher('scan2',Range,queue_size=1)
pub3 = rospy.Publisher('scan3',Range,queue_size=1)
pub4 = rospy.Publisher('scan4',Range,queue_size=1)
</pre></table></code></div></div><p>í•˜ë©´ ìˆœì„œëŒ€ë¡œ ë‚ ì•„ê°ˆ ê²ƒì´ë‹¤.</p><p>range íƒ€ì…ì„ í™•ì¸í•˜ê¸° ìœ„í•´</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>rosmsg show sensor_msgs/Range
</pre></table></code></div></div><p><img data-src="/assets/img/dev/week4/day4/rangeshow.png" data-proofer-ignore></p><p>ë” ìì„¸íˆ ë³´ë ¤ë©´ http://docs.ros.org/en/melodic/api/sensor_msgs/html/msg/Range.html ë¡œ ê°€ë³´ë©´ ìì„¸íˆ ë‚˜ì˜¨ë‹¤.</p><p>ë‹¨ìˆœí•˜ê²Œ ì–¼ë§Œí¼ ë–¨ì–´ì ¸ ìˆëŠ”ê°€ì— ëŒ€í•œ ê²ƒìœ¼ë¡œ ë¶€ì±„ê¼´ ëª¨ì–‘ìœ¼ë¡œ ì¸¡ì •í•¨ì„ ë³´ì—¬ì¤€ë‹¤. ëŒ€ì²´ë¡œ ì „íŒŒë‚˜ ìŒíŒŒ ë“±ì€ ë¶€ì±„ê¼´ ëª¨ì–‘ìœ¼ë¡œ ë‚ ì•„ê°€ì„œ ë‹¤ì‹œ ëŒì•„ì˜¬ ê²ƒì´ë‹¤.</p><ul><li>header.timestamp: ì†¡ì‹ ë¶€í„° ìˆ˜ì‹ ê¹Œì§€ì˜ ì‹œê°„ì„ ë‚˜íƒ€ë‚¸ ê²ƒì´ë‹¤.<li>radiation_type: soundì¸ì§€ ì ì™¸ì„ ì¸ì§€ ë“±ë“±ì˜ íƒ€ì…ì„ ë‚˜íƒ€ë‚¸ë‹¤.<li>field.of_view: ì¤‘ê°„ì„ 0ìœ¼ë¡œ ê¸°ì¤€ì¡ì•„ ë°˜ ë¶€ì±„ê¼´ì˜ ê°ë„ (ëŒ€ì²´ë¡œ ì´ˆìŒíŒŒ ì„¼ì„œëŠ” ì™¼/ì˜¤ ê°ê° 15ë„, ì´ 30ë„)<li>min_range/max_range: ì´ ì¥ì¹˜ê°€ ê°ì§€í•  ê±°ë¦¬ì˜ ê²½ê³„ê°’<li><p>range: ê°ì§€í•œ ê±°ë¦¬ì˜ ê°’ (-inf(ê±°ë¦¬ê°€ ë„ˆë¬´ ê°€ê¹Œìš¸ ë–„), +inf(ê±°ë¦¬ê°€ ë„ˆë¬´ ë©€ ë•Œ))</p><li>lidar_range.py</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env pythonm
</span>
<span class="c1"># range, header import
</span><span class="kn">import</span> <span class="n">serial</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">rospy</span>
<span class="kn">from</span> <span class="n">sensor_msgs.msg</span> <span class="kn">import</span> <span class="n">Range</span>
<span class="kn">from</span> <span class="n">std_msgs</span> <span class="kn">import</span> <span class="n">Header</span>

<span class="c1"># mk node
</span><span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="s">'lidar_range'</span><span class="p">)</span>

<span class="c1"># mk 4 publisher
</span><span class="n">pub1</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Publisher</span><span class="p">(</span><span class="s">'scan1'</span><span class="p">,</span><span class="n">Range</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pub2</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Publisher</span><span class="p">(</span><span class="s">'scan2'</span><span class="p">,</span><span class="n">Range</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pub3</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Publisher</span><span class="p">(</span><span class="s">'scan3'</span><span class="p">,</span><span class="n">Range</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pub4</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Publisher</span><span class="p">(</span><span class="s">'scan4'</span><span class="p">,</span><span class="n">Range</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">msg</span> <span class="o">=</span> <span class="nc">Range</span><span class="p">()</span>
<span class="c1"># fill the range field - header information, required information about range expression of cone shape
</span><span class="n">header</span> <span class="o">=</span> <span class="nc">Header</span><span class="p">()</span>
<span class="n">header</span><span class="p">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="s">"sensorXY"</span>
<span class="n">msg</span><span class="p">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>
<span class="n">msg</span><span class="p">.</span><span class="n">radiation_type</span> <span class="o">=</span> <span class="nc">Range</span><span class="p">().</span><span class="n">ULTRASOUND</span>
<span class="n">msg</span><span class="p">.</span><span class="n">min_range</span> <span class="o">=</span> <span class="mf">0.02</span>                    <span class="c1"># 2cm
</span><span class="n">msg</span><span class="p">.</span><span class="n">max_range</span> <span class="o">=</span> <span class="mf">2.0</span>                     <span class="c1"># 2m
</span><span class="n">msg</span><span class="p">.</span><span class="n">field_of_view</span> <span class="o">=</span> <span class="p">(</span><span class="mf">30.0</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)</span><span class="o">*</span><span class="mf">3.14</span>   <span class="c1"># radian expression 1/6 pi
</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="p">.</span><span class="nf">is_shutdown</span><span class="p">():</span>
    <span class="n">msg</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">stamp</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>

    <span class="c1"># pushing the distance to the object at msg.range in meters and publishing topic
</span>    <span class="n">msg</span><span class="p">.</span><span class="nb">range</span> <span class="o">=</span> <span class="mf">0.4</span>
    <span class="n">pub1</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">msg</span><span class="p">.</span><span class="nb">range</span> <span class="o">=</span> <span class="mf">0.8</span>
    <span class="n">pub2</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">msg</span><span class="p">.</span><span class="nb">range</span> <span class="o">=</span> <span class="mf">1.2</span>
    <span class="n">pub3</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">msg</span><span class="p">.</span><span class="nb">range</span> <span class="o">=</span> <span class="mf">1.6</span>
    <span class="n">pub4</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>    

    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span> <span class="c1"># slow publish
</span></pre></table></code></div></div><ul><li>lidar_range.launch</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nt">&lt;launch&gt;</span>
    <span class="c">&lt;!-- rviz display --&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"rviz_visualizer"</span> <span class="na">pkg=</span><span class="s">"rviz"</span> <span class="na">type=</span><span class="s">"rviz"</span> <span class="na">required=</span><span class="s">"true"</span>
        <span class="na">args=</span><span class="s">"-d $(find rviz_lidar)/rviz/lidar_range.rviz"</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- implement the python file we just made --&gt;</span>    
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"lidar_range"</span> <span class="na">pkg=</span><span class="s">"rviz_lidar"</span> <span class="na">type=</span><span class="s">"lidar_range.py"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></table></code></div></div><h3 id="ì‹¤í–‰-2">ì‹¤í–‰ <a href="#ì‹¤í–‰-2" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>roslaunch rviz_lidar lidar_range.launch
</pre></table></code></div></div><h3 id="í† í”½-ë‚´ìš©-í™•ì¸">í† í”½ ë‚´ìš© í™•ì¸ <a href="#í† í”½-ë‚´ìš©-í™•ì¸" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>ê·¸ë¦¼ì´ ê·¸ë ¤ì§€ê¸° ì „ì— í† í”½ì´ ì˜ ë‚ ì•„ê°€ê³  ìˆëŠ”ì§€ ë´ì•¼ í•œë‹¤.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="nv">$ </span>rostopic list
...
/scan1
/scan2
/scan3
/scan4

<span class="nv">$ </span>rostopic <span class="nb">echo </span>scan1
header:
    <span class="nb">seq</span>: 24
    stamp:
        secs: 
        nsecs:
    frame_id: <span class="s2">"sensorXY"</span>
radiation_type: 0
field_of_type: 0.52333
min_range: 0.019999
max_range: 2.0
range: 0.4000
</pre></table></code></div></div><p>ë‹¤ ì˜ ë‚˜ì˜¤ë©´ ëœ ê²ƒì´ë‹¤.</p><h3 id="rviz-ì„¤ì •">RVIZ ì„¤ì • <a href="#rviz-ì„¤ì •" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ol><li>fixed frame ì§€ì •<ul><li>ì›ë˜ëŠ” mapìœ¼ë¡œ ë˜ì–´ ìˆê¸°ì— sensorXYë¡œ ë°”ê¿”ì•¼ í•œë‹¤.</ul><li>plugin ì¶”ê°€<ul><li>display í•˜ë‹¨ì— add ëˆ„ë¥´ê³  by topic íƒ­ì—ì„œ /scan - rangeê°€ ìˆë‹¤. ì´ë¥¼ ëˆ„ë¥´ê³  ok</ul><li>í† í”½ ì´ë¦„ í™•ì¸<ul><li>ìˆ˜ì‹ í•  í† í”½ì´ ì˜ ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸</ul><li>ìƒìƒ í™•ì¸<ul><li>color ì§€ì •ì—ì„œ ìì‹ ì´ ì›í•˜ëŠ” ìƒ‰ìƒ í´ë¦­</ul></ol><p>4ê°œ ëª¨ë‘ ì„ íƒë  ê²½ìš° ê²¹ì³ì„œ í‘œì‹œë  ìˆ˜ ìˆì–´ í™•ì¸ì´ ì–´ë ¤ìš¸ ìˆ˜ ìˆë‹¤.</p><p><br /></p><h2 id="ë¼ì´ë‹¤ì™€-ìœµí•©í•˜ì—¬-ì‹œê°í™”">ë¼ì´ë‹¤ì™€ ìœµí•©í•˜ì—¬ ì‹œê°í™” <a href="#ë¼ì´ë‹¤ì™€-ìœµí•©í•˜ì—¬-ì‹œê°í™”" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>rosbagíŒŒì¼ì—ì„œ í† í”½(/scan)ì„ ë°œí–‰í•˜ì—¬ lidar_urdf.pyë¡œ ë°›ì•„ì§€ê³ , ì´ë¥¼ ì •ì œí•˜ì—¬ 4ê°œì˜ í† í”½ì„ ë°œí–‰í•¨ìœ¼ë¡œì¨ rvizë¡œ ì „ë‹¬ë˜ê²Œ í•œë‹¤.</p><p>1.íŒŒì´ì¬ íŒŒì¼(lidar_urdf.py)</p><p>LaserScan íƒ€ì…ì˜ ë°ì´í„°ë¥¼ Range íƒ€ì…ìœ¼ë¡œ ë³€ê²½í•´ì•¼ í•œë‹¤. /scan í† í”½ì„ ë°›ì•„ scan1, scan2, scan3, scan4, 4ê°œì˜ í† í”½ìœ¼ë¡œ ë°œí–‰</p><p><img data-src="/assets/img/dev/week4/day4/laserrange.png" data-proofer-ignore></p><p><br /></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">import</span> <span class="n">serial</span>
<span class="p">...</span>

<span class="k">def</span> <span class="nf">lidar_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">lidar_points</span>
    <span class="n">lidar_points</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">ranges</span>

<span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="s">"lidar"</span><span class="p">)</span>
<span class="p">...</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="p">.</span><span class="nf">is_shutdown</span><span class="p">():</span>
    <span class="p">...</span>
    <span class="n">h</span><span class="p">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="s">"front"</span>
    <span class="n">msg</span><span class="p">.</span><span class="nb">range</span> <span class="o">=</span> <span class="n">lidar_points</span><span class="p">[</span><span class="mi">90</span><span class="p">]</span> <span class="c1"># ë¶ì„ ì „ë°©ì„ ë‘ì—ˆì„ ë•Œ ì´ìª½ì´ 0ë„ ì´ë¯€ë¡œ, frontëŠ” 3ì‹œë°©í–¥ì´ë¥´ëª¨ 90
</span>    <span class="p">...</span>

    <span class="n">h</span><span class="p">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="s">"back"</span>
    <span class="n">msg</span><span class="p">.</span><span class="nb">range</span> <span class="o">=</span> <span class="n">lidar_points</span><span class="p">[</span><span class="mi">270</span><span class="p">]</span> <span class="c1"># 9ì‹œë°©í–¥ì´ë¯€ë¡œ 270
</span></pre></table></code></div></div><blockquote><p>ğŸˆ ì¤‘ìš”í•œ ê²ƒì€ frame_idì˜ ì´ë¦„ê³¼ urdfì˜ ë¸”ë¡ì˜ ì´ë¦„ì„ ì¼ì¹˜ì‹œì¼œì•¼ í•œë‹¤.</p></blockquote><p><br /></p><p>2.URDF ëª¨ë¸ë§ íŒŒì¼(lidar_urdf.urdf)</p><p>ì¤‘ì•™ì— ë¹¨ê°„ìƒ‰ ë°•ìŠ¤ë¥¼ ë§Œë“¤ê³ , 4ë°©í–¥ì—ì„œ ì„¼ì„œ í”„ë ˆì„ì„ ì—°ê²°í•œë‹¤.</p><ul><li>base_linkì— ê°€ë¡œì„¸ë¡œ 20cm, redë°•ìŠ¤ baseplateë¥¼ ë§Œë“¤ì–´ ì—°ê²°<li>ì„¼ì„œëŠ” x,y, ì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ì‹¬ì—ì„œ 10cmì”© ì´ë™ì‹œì¼œì„œ ë°•ìŠ¤ì˜ ëë¶€ë¶„ì— ë°°ì¹˜</ul><p><br /></p><p>ì¤‘ì•™ ë°•ìŠ¤ì˜ í¬ê¸°ëŠ” ê°€ë¡œxì„¸ë¡œxë†’ì´ = 0.2m x 0.2m x 0.07m</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nt">&lt;joint</span> <span class="na">name=</span><span class="s">"baseplate_to_front"</span> <span class="na">type=</span><span class="s">"fixed"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;parent</span> <span class="na">link=</span><span class="s">"baseplate"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;child</span> <span class="na">link=</span><span class="s">"front"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;origin</span> <span class="na">rpy=</span><span class="s">"0 0 0"</span> <span class="na">xyz=</span><span class="s">"0.1 0 0"</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- xyzì—ì„œ ì—°ê²°ìœ„ì¹˜ëŠ” ì¤‘ì‹¬ì—ì„œ xì¶•ìœ¼ë¡œ 10cmì´ë™ --&gt;</span>
<span class="nt">&lt;joint</span> <span class="na">name=</span><span class="s">"baseplate_to_back"</span> <span class="na">type=</span><span class="s">"fixed"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;parent</span> <span class="na">link=</span><span class="s">"baseplate"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;child</span> <span class="na">link=</span><span class="s">"back"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;origin</span> <span class="na">rpy=</span><span class="s">"0 0 3.14"</span> <span class="na">xyz=</span><span class="s">"-0.1 0 0"</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- xyzì—ì„œ ì—°ê²°ìœ„ì¹˜ëŠ” ì¤‘ì‹¬ì—ì„œ xì¶•ìœ¼ë¡œ -10cmì´ë™, ë°©í–¥ì€ zì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ pië§Œí¼ ëŒì•„ì•¼ í•œë‹¤. --&gt;</span>
</pre></table></code></div></div><div class="language-markdown highlighter-rouge"><div class="code-header"> <span data-label-text="Markdown"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>link - base_link -<span class="se">\&gt;</span> joint - base_link_to_baseplate -<span class="se">\&gt;</span> link - baseplate  -<span class="se">\&gt;</span> joint - baseplate_to_front -<span class="se">\&gt;</span> link - front 
                                                                          -<span class="se">\&gt;</span> joint - baseplate_to_back -<span class="se">\&gt;</span> link - back
</pre></table></code></div></div><p><br /></p><p>3.RVIZ ì„¤ì • íŒŒì¼(lidar_urdf.rviz)</p><p>rviz í”„ë¡œê·¸ë¨ì— ë“¤ì–´ê°€ì„œ add -&gt; 4ê°œì˜ rangeíƒ€ì…ì„ ì¶”ê°€</p><p><br /></p><p>4.ëŸ°ì¹˜ íŒŒì¼(lidar_urdf.launch)</p><ul><li>ë°•ìŠ¤ í˜•ìƒì„ ìœ„í•œ ëª¨ë¸ë§ íŒŒì¼(lidar_urdf.urdf)<li>RVIZ ì„¤ì • íŒŒì¼(lidar_urdf.rviz)<li>ë¼ì´ë‹¤ í† í”½ ë°œí–‰(lidar_topic.bag)<li>rosbagíŒŒì¼ ì‹¤í–‰(<code class="language-plaintext highlighter-rouge">&lt;node pkg="rosbag" type="play" output="screen" ... args="$(find rviz_lidar)/src/lidar_topic.bag"/&gt;</code>)<li>í† í”½ ë³€í™˜(lidar_urdf.py)</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- lidar_urdf.launch --&gt;</span>
<span class="nt">&lt;launch&gt;</span>

<span class="nt">&lt;/launch&gt;</span>
</pre></table></code></div></div><p><br /></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>roslaunch rviz_lidar lidar_urdf.launch
</pre></table></code></div></div><p>ì´ë¥¼ ì‹¤í–‰í•˜ë©´ ì›ë¿”ë“¤ì´ ë¬¼ì²´ì™€ì˜ ê±°ë¦¬ì— ë”°ë¼ ì§§ì•„ì¡Œë‹¤ ê¸¸ì–´ì¡Œë‹¤ í•œë‹¤.</p><p><br /></p><p><br /></p><h1 id="ì´ˆìŒíŒŒ-ì„¼ì„œ-ros-íŒ¨í‚¤ì§€">ì´ˆìŒíŒŒ ì„¼ì„œ ROS íŒ¨í‚¤ì§€</h1><p>ì´ˆìŒíŒŒ ì„¼ì„œ : ì¥ì• ë¬¼ê¹Œì§€ì˜ ê±°ë¦¬ë¥¼ ì´ˆìŒíŒŒë¥¼ ì†¡ìˆ˜ì‹ í•´ì„œ ì•Œë ¤ì£¼ëŠ” ì„¼ì„œë‹¤.</p><p><img data-src="/assets/img/dev/week4/day4/ultrasonic.jpg" data-proofer-ignore></p><p><br /></p><p>ì´ˆìŒíŒŒì„¼ì„œëŠ” ì•„ë‘ì´ë…¸ë¥¼ ê±°ì³ì„œ í”„ë¡œì„¸ìŠ¤ì™€ ì—°ê²°ëœë‹¤. ë…¸ë“œë¡œ ì´ ë‘˜ ì‚¬ì´ë¥¼ í†µì‹ í•œë‹¤.</p><p>my_ultraì´ë¦„ì˜ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•  ê²ƒì´ê³ , í† í”½ì˜ ì´ë¦„ì€ /ultraìœ¼ë¡œ ìƒì„±í•  ê²ƒì´ë‹¤.</p><p>í† í”½ì˜ ë‚´ìš©</p><ul><li>íƒ€ì…: sensor_msgs/Int32MultiArray<li>êµ¬ì„±<ul><li>std_msgs/MultiArrayLayout layout<ul><li>std_msgs/MultiArrayDimension[] dim<li>string label<li>uint32 size<li>uint32 stride<li>unit32 data_offset</ul><li>int32[] data</ul></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>xycar_ws
  âŠ¢ build
  âŠ¢ devel
  âˆŸ src
      âˆŸ my_ultra
          âŠ¢ launch
              âˆŸ ultra_scan.launch
          âˆŸ src
              âˆŸ ultra_scan.py
</pre></table></code></div></div><h3 id="íŒ¨í‚¤ì§€-ìƒì„±-1">íŒ¨í‚¤ì§€ ìƒì„± <a href="#íŒ¨í‚¤ì§€-ìƒì„±-1" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>my_ultra ì´ë¦„ì˜ íŒ¨í‚¤ì§€ ìƒì„± / ì„œë¸Œ í´ë” ìƒì„±</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>xycar_ws/src<span class="nv">$ </span>caktin_create_pkg my_ultra std_msgs rospy
xycar_ws/src<span class="nv">$ </span><span class="nb">mkdir </span>launch
xycar_ws/src<span class="nv">$ </span><span class="nb">cd </span>launch
xycar_ws/src/launch<span class="nv">$ </span>gedit ultra_scan.launch
xycar_ws/src<span class="nv">$ </span><span class="nb">cd</span> ../src
</pre></table></code></div></div><ul><li>ultra_scan.py</ul><p>ì´ˆìŒíŒŒì„¼ì„œë¡œë¶€í„° ì£¼ë³€ ë¬¼ì²´ê¹Œì§€ì˜ ê±°ë¦¬ê°’ì„ ë°›ì•„ ì¶œë ¥í•˜ëŠ” ì½”ë“œë‹¤.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">import</span> <span class="n">rospy</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="c1"># prepare using Int32MultiArray msg
</span><span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">Int32MultiArray</span>

<span class="c1"># storage space
</span><span class="n">ultra_msg</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c1"># define the callback function to implement, if the topic of ultrasound come in
</span><span class="k">def</span> <span class="nf">ultra_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">ultra_msg</span>
    <span class="n">ultra_msg</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">data</span>

<span class="c1"># mk node
</span><span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="s">"ultra_node"</span><span class="p">)</span>
<span class="c1"># define subcriber to receive msg type of Int32MultiArray
</span><span class="n">rospy</span><span class="p">.</span><span class="nc">Subcriber</span><span class="p">(</span><span class="s">"xycar_ultrasonic"</span><span class="p">,</span> <span class="n">Int32MultiArray</span><span class="p">,</span> <span class="n">ultra_callback</span><span class="p">)</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="p">.</span><span class="nf">is_shutdown</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">ultra_msg</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">continue</span>
    
    <span class="c1"># print ultrasound data    
</span>    <span class="nf">print</span><span class="p">(</span><span class="n">ultra_msg</span><span class="p">)</span>

    <span class="c1"># sleep 0.5s
</span>    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>ultra_scan.launch</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nt">&lt;launch&gt;</span>
    <span class="c">&lt;!-- make ultrasonic device run --&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"xycar_ultrasonic"</span> <span class="na">type=</span><span class="s">"xycar_ultrasonic.py"</span>
        <span class="na">name=</span><span class="s">"xycar_ultrasonic"</span> <span class="na">output=</span><span class="s">"screen"</span> <span class="nt">/&gt;</span>
    
    <span class="c">&lt;!-- implement file we just made --&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"my_ultra"</span> <span class="na">type=</span><span class="s">"ultra_scan.py"</span> <span class="na">name=</span><span class="s">"my_ultra"</span> <span class="na">output=</span><span class="s">"screen"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></table></code></div></div><h3 id="ì‹¤í–‰-3">ì‹¤í–‰ <a href="#ì‹¤í–‰-3" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>roslaunch my_ultra ultra_scan.launch
</pre></table></code></div></div><p>ì´ 8ê°œì˜ ì •ë³´ê°€ ë“¤ì–´ì˜¬ ê²ƒì´ë‹¤. ì´ëŠ” ìš´ì „ì„ì„ 0ì„ ê¸°ì¤€ìœ¼ë¡œ ì‹œê³„ë°©í–¥ìœ¼ë¡œ ë²ˆí˜¸ë¥¼ ë§¤ê¸´ë‹¤.</p><p><br /></p><h2 id="ì´ˆìŒíŒŒ-ì„¼ì„œì™€-ì•„ë‘ì´ë…¸ë¥¼-ì‚¬ìš©í•˜ì—¬-ros-íŒ¨í‚¤ì§€-ì œì‘">ì´ˆìŒíŒŒ ì„¼ì„œì™€ ì•„ë‘ì´ë…¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ROS íŒ¨í‚¤ì§€ ì œì‘ <a href="#ì´ˆìŒíŒŒ-ì„¼ì„œì™€-ì•„ë‘ì´ë…¸ë¥¼-ì‚¬ìš©í•˜ì—¬-ros-íŒ¨í‚¤ì§€-ì œì‘" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="ì´ˆìŒíŒŒì„¼ì„œ-ros-íŒ¨í‚¤ì§€">ì´ˆìŒíŒŒì„¼ì„œ ROS íŒ¨í‚¤ì§€ <a href="#ì´ˆìŒíŒŒì„¼ì„œ-ros-íŒ¨í‚¤ì§€" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>ì´ˆìŒíŒŒì„¼ì„œë¥¼ ì œì–´í•˜ì—¬ ë¬¼ì²´ê¹Œì§€ì˜ ê±°ë¦¬ë¥¼ ì•Œì•„ë‚´ê³  ê·¸ ì •ë³´ë¥¼ ros í† í”½ìœ¼ë¡œ ë§Œë“¤ì–´ ë…¸ë“œë“¤ì—ê²Œ ë³´ë‚¸ë‹¤.</p><ol><li>ì´ˆìŒíŒŒ ì„¼ì„œ<ul><li>ë¬¼ì²´ë¡œ ì´ˆìŒíŒŒë¥¼ ì˜ê³ , ë°˜ì‚¬ëœ ì´ˆìŒíŒŒ ì‹ í˜¸ë¥¼ ê°ì§€<li>ì²˜ìŒ ì´ˆìŒíŒŒë¥¼ ìœ ì‹œì ê³¼ ë°˜ì‚¬íŒŒë¥¼ ìˆ˜ì‹ í•œ ì‹œì ì„ í‘œì‹œí•œ ì „ê¸° ì‹ í˜¸ì¸ í„ìŠ¤(pulse) ì‹ í˜¸ë¥¼ ì•„ë‘ì´ë…¸ë¡œ ë³´ëƒ„</ul><li>ì•„ë‘ì´ë…¸<ul><li>ì´ˆìŒíŒŒì„¼ì„œê°€ ë³´ë‚´ì¤€ í„ìŠ¤ì‹ í˜¸ë¥¼ ë°›ì•„ ë¶„ì„<li>ì´ˆìŒíŒŒë¥¼ ìœ ì‹œì ê³¼ ë°˜ì‚¬íŒŒë¥¼ ë°›ì€ ì‹œì  ì‚¬ì´ì˜ ì‹œê°„ì°¨ë¥¼ ì´ìš©í•´ì„œ ë¬¼ì²´ê¹Œì§€ì˜ ê±°ë¦¬ë¥¼ ê³„ì‚°í•˜ê³  ì´ë¥¼ rosì— ì•Œë ¤ì¤€ë‹¤.<li>serial í†µì‹ ìœ¼ë¡œ rosì— ë³´ë‚¸ë‹¤. ê°„ë‹¨í•˜ê³  ë‹¤ë¥¸ ì†Œí”„íŠ¸ì›¨ì–´ í•„ìš”ì—†ì´ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.</ul></ol><blockquote><p>ì´ì²˜ëŸ¼ ì‘ì€ ë³´ë“œì—ì„œ ëŒì•„ê°€ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ íŒì›¨ì–´ë¼ í•œë‹¤. ëŒ€ì²´ë¡œ cì–¸ì–´ë¡œ ê°œë°œë˜ì–´ ìˆë‹¤.</p></blockquote><ol><li>ros<ul><li>ì•„ë‘ì´ë…¸ê°€ ë³´ë‚´ì¤€ ë¬¼ì²´ê¹Œì§€ì˜ ê±°ë¦¬ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê¸° ì¢‹ì€ í˜•íƒœë¡œ ì ì ˆíˆ ê°€ê³µ<li>ê·¸ê²ƒì„ ROS í† í”½ì— ë‹´ì•„ ê·¸ê²Œ í•„ìš”í•œ ë…¸ë“œë“¤ì—ê²Œ Publish<li>headerë‚˜ 1:n, n:n ë“±ì˜ ë°©ë²•ì„ êµ¬í˜„í•˜ë©´ ëœë‹¤.</ul></ol><p><br /></p><h3 id="ì œì‘ì„-ìœ„í•œ-1ë‹¨ê³„---í•˜ë“œì›¨ì–´ë¥¼-ì´í•´í•˜ì">ì œì‘ì„ ìœ„í•œ 1ë‹¨ê³„ - í•˜ë“œì›¨ì–´ë¥¼ ì´í•´í•˜ì <a href="#ì œì‘ì„-ìœ„í•œ-1ë‹¨ê³„---í•˜ë“œì›¨ì–´ë¥¼-ì´í•´í•˜ì" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>ì´ˆìŒíŒŒ (ultrasonic wave)</p><ul><li>ì¸ê°„ì˜ ê·€ê°€ ë“¤ì„ ìˆ˜ ìˆëŠ” ê°€ì²­ ì£¼íŒŒìˆ˜ ëŒ€ì—­ë³´ë‹¤ ë†’ì€ ì§„ë™ìˆ˜ë¡œ ë°œìƒí•˜ëŠ” íŒŒë™<li>ê°€ì²­ ì§„ë™ìˆ˜ëŠ” ì‚¬ëŒë§ˆë‹¤ ë‹¤ë¥´ì§€ë§Œ ì•½ 20Hz~20kHz</ul><p><img data-src="/assets/img/dev/week4/day3/wave.jpg" data-proofer-ignore></p><ul><li>ì´ˆìŒíŒŒ ì„¼ì„œëŠ” ì´ˆìŒíŒŒë¥¼ ì´ìš©í•˜ì—¬ ì„¼ì„œë¡œë¶€í„° ì‚¬ë¬¼ê¹Œì§€ì˜ ì§ì„ ê±°ë¦¬ë¥¼ ì¸¡ì •í•œë‹¤.</ul><p>ì´ˆìŒíŒŒì„¼ì„œ</p><ul><li>ë¬¼ì²´ë¡œ ì´ˆìŒíŒŒë¥¼ ì˜ê³  ë°˜ì‚¬ëœ ì´ˆìŒíŒŒ ì‹ í˜¸ë¥¼ ê°ì§€<li>ì²˜ìŒ ì´ˆìŒíŒŒë¥¼ ìœ ì‹œì ë¶€í„° ë°˜ì‚¬íŒŒë¥¼ ìˆ˜ì‹ í•œ ì‹œì ì„ í‘œì‹œí•œ pulse ì‹ í˜¸ë¥¼ ì•„ë‘ì´ë…¸ì—ê²Œ ë³´ëƒ„</ul><p><br /></p><h3 id="ì œì‘ì„-ìœ„í•œ-2ë‹¨ê³„---ì•„ë‘ì´ë…¸ë¥¼-ì´í•´í•˜ì">ì œì‘ì„ ìœ„í•œ 2ë‹¨ê³„ - ì•„ë‘ì´ë…¸ë¥¼ ì´í•´í•˜ì <a href="#ì œì‘ì„-ìœ„í•œ-2ë‹¨ê³„---ì•„ë‘ì´ë…¸ë¥¼-ì´í•´í•˜ì" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>ì•„ë‘ì´ë…¸</p><ul><li>ì»´í“¨í„°ê°€ ë‹¤ ì•Œì•„ì„œ í• ë§Œí¼ ì¢‹ì€ ì„±ëŠ¥ì´ë¼ë©´ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.<li>ì´ˆìŒíŒŒì„¼ì„œê°€ pulse ì‹ í˜¸ë¥¼ ë°›ì•„ ë¶„ì„<li>ì´ˆìŒíŒŒë¥¼ ìœ ì‹œì ê³¼ ë°˜ì‚¬íŒŒë¥¼ ë°›ì€ ì‹œì ì˜ ì‹œê°„ì°¨ì´ë¥¼ ì´ìš©í•´ì„œ ë¬¼ì²´ê¹Œì§€ì˜ ê±°ë¦¬ë¥¼ ê³„ì‚°í•˜ê³  ì´ë¥¼ ROSì— ì•Œë¦°ë‹¤.</ul><p><img data-src="/assets/img/dev/week4/day4/aduino.png" data-proofer-ignore></p><p>ê° ì„¼ì„œì˜ Vcc,Trig,Echo,Gnd ë¥¼ ê° í•€ì— ì—°ê²°í•œë‹¤.</p><ul><li>Vcc : 5V<li>Trig : D2<ul><li>ì•„ë‘ì´ë…¸ ì…ì¥ì—ì„œ D2ëŠ” ë°›ëŠ” ê²ƒ</ul><li>Echo : D3<ul><li>ì•„ë‘ì´ë…¸ ì…ì¥ì—ì„œ D3ëŠ” ë‚´ë³´ë‚´ëŠ” ê²ƒ</ul><li>Gnd : GND</ul><p><img data-src="/assets/img/dev/week4/day4/aduino_sonic.png" data-proofer-ignore></p><p>ì•„ë‘ì´ë…¸ì˜ íŒì›¨ì–´ë¥¼ ê°œë°œí•˜ëŠ” IDEê°€ ì¡´ì¬í•œë‹¤. ì•„ë‘ì´ë…¸ ì½”ë“œ ì‘ì„±í•  ë•Œë‚˜ ì œì‘ëœ íŒì›¨ì–´ë¥¼ ì•„ë‘ì´ë…¸ì— ì ì„ ë•Œ ì‚¬ìš©í•œë‹¤.</p><p><a href="https://www.arduino.cc/en/software">ë‹¤ìš´ë¡œë“œ ë§í¬</a></p><p>ë‹¤ìš´ë¡œë“œë¥¼ í•œ í›„ ì••ì¶•ì„ í’€ì–´ ì•ˆì— ìˆëŠ” install.shë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ëœë‹¤.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo</span> ~/Downloads/Arduino-1.8.19-linux64/arduino-1.8.19/install.sh
Adding desktop shortcut, menu item and file associations <span class="k">for </span>Arduino IDE ...
</pre></table></code></div></div><p>ê·¸ ë‹¤ìŒ ì‹¤í–‰</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>arduino
</pre></table></code></div></div><p>ì‹¤í–‰ì´ ë˜ë©´ <code class="language-plaintext highlighter-rouge">ultrasonic_1_fw.ino</code> íŒŒì¼ì„ ì‘ì„±í•œë‹¤.</p><p>ì´ íŒŒì¼ì˜ ë‚´ìš©ì€ êµ¬ê¸€ë§í•˜ë©´ ë‚˜ì˜¨ë‹¤.</p><p>ì†ŒìŠ¤ ì½”ë“œ (ì´ˆìŒíŒŒì„¼ì„œê°€ ë³´ë‚´ëŠ” ì‹ í˜¸ë¡œë¶€í„° ê±°ë¦¬ì •ë³´ ì¶”ì¶œ)</p><pre><code class="language-arduino">/*
HL-340 ì´ˆìŒíŒŒ ì„¼ì„œ ì•„ë‘ì´ë…¸ íŒì›¨ì–´
*/

#define trig 2 // íŠ¸ë¦¬ê±° í•€ ì„ ì–¸
#define echo 3 // ì—ì½” í•€ ì„ ì–¸

void setup()
{
    Serial.begin(9600);     // í†µì‹ ì†ë„ 9600bpsë¡œ ì‹œë¦¬ì–¼ í†µì‹  ì‹œì‘
    pinMode(trig, OUTPUT);  // íŠ¸ë¦¬ê±° í•€ì„ ì¶œë ¥ìœ¼ë¡œ ì„ ì–¸
    pinMode(echo, INPUT);   // ì—ì½”í•€ì„ ì…ë ¥ìœ¼ë¡œ ì„ ì„ 
}

void loop() {
    long duration, distance;    // ê±°ë¦¬ ì¸¡ì •ì„ ìœ„í•œ ë³€ìˆ˜ ì„ ì–¸
    // íŠ¸ë¦¬ê±° í•€ìœ¼ë¡œ 10us ë™ì•ˆ í„ìŠ¤ ì¶œë ¥
    digitalWrite(trig, LOW);    // Trig í•€ Low
    delayMicroseconds(2);       // 2us ë”œë ˆì´
    digitalWrite(trig, HIGH);   // Trig í•€ High
    delayMicroseconds(10);      // 2us ë”œë ˆì´
    digitalWrite(trig, LOW);    // Trig í•€ Low

    // pulseln() í•¨ìˆ˜ëŠ” í•€ì—ì„œ í„ìŠ¤ ì‹ í˜¸ë¥¼ ì½ì–´ì„œ ë§ˆì´í¬ë¡œì´ˆ ë‹¨ìœ„ë¡œ ë°˜í™˜
    duration = pulseIn(echo, HIGH);
    distance = duration * 170 / 1000;   // ì™•ë³µì‹œê°„ì´ë¯€ë¡œ 340/2=170 ê³±í•˜ëŠ”ê±¸ë¡œ ê³„ì‚°, ë§ˆì´í¬ë¡œì´ˆë¥¼ mmë¡œ ë³€í™˜í•˜ê¸° ìœ„í•´ 1000ë‚˜ëˆ”
    Serial.print("Distance(mm): ");
    Serial.println(distance);           // ê±°ë¦¬ì •ë³´ë¥¼ ì‹œë¦¬ì–¼ ëª¨ë‹ˆí„°ì— ì¶œë ¥
    delay(100);
}
</code></pre><p><br /></p><p>ì•„ë‘ì´ë…¸ê°€ pcì— ì—°ê²°ë˜ì—ˆëŠ”ì§€ë¥¼ í™•ì¸í•´ë´ì•¼ í•œë‹¤. ì´ë¥¼ ìœ„í•´</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>lsusb
Bus 004 Device 002: ID 0bc2:231a Seagate RSS LLC 
Bus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 003 Device 006: ID 2b7e:0134  
Bus 003 Device 005: ID 04e8:730b Samsung Electronics Co., Ltd 
Bus 003 Device 011: ID 04d9:1836 Holtek Semiconductor, Inc. 
Bus 003 Device 016: ID 1a86:7523 QinHeng Electronics HL-340 USB-Serial adapter
</pre></table></code></div></div><p>ë¦¬ìŠ¤íŠ¸ ì¤‘ì— ìì‹ ì˜ ì¥ì¹˜ ë²ˆí˜¸ë¥¼ ì°¾ëŠ”ë‹¤. ë‚˜ì˜ ê²½ìš° HL-340 ì´ë‹¤.</p><blockquote><p>ì•„ë‘ì´ë…¸ì™€ pcê°€ ë¬¼ë¦¬ì ìœ¼ë¡œ USBì¼€ì´ë¸”ë¡œ ì—°ê²°ë˜ì–´ ìˆìœ¼ë‚˜ ë‚´ë¶€ì ìœ¼ë¡œëŠ” serialí†µì‹ ì´ ì´ë£¨ì–´ì§€ê³  ìˆë‹¤. ë”°ë¼ì„œ ì´ì— ë§ê²Œ serialí†µì‹ ìœ¼ë¡œ ë§ì¶°ì„œ ì§œì•¼ í•œë‹¤. ì´ë¥¼ <strong>Serial over USB</strong>ë¼ í•œë‹¤.</p></blockquote><p><br /></p><p>ì¶œë ¥ì´ ë˜ì—ˆë‹¤ë©´ í•˜ë“œì›¨ì–´ì ìœ¼ë¡œëŠ” í†µì‹ ì´ ë˜ê³  ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ ì•„ë‘ì´ë…¸ì—ì„œ ì—°ê²°ì´ ë˜ê³  ìˆëŠ”ì§€ë„ í™•ì¸í•´ë´ì•¼ í•œë‹¤.</p><p>tool ë©”ë‰´ì—ì„œ board/ processor / port í™•ì¸</p><ol><li>board : arduion Nano<li>processor : ATmega328P<li>Port : /dev/ttyUSB0 ë˜ëŠ” /dev/ttyACM0</ol><p>ì´ê²ƒì„ ì˜ ì„ íƒí•˜ë©´ ìƒë‹¨ì— v(ì²´í¬)ë¥¼ ëˆŒëŸ¬ ë””ë²„ê¹…ì´ ê°€ëŠ¥í•´ì§„ë‹¤. ê·¸ í›„ ì˜ ë™ì‘ë˜ë©´ ì˜†ì— í™”ì‚´í‘œë¥¼ í´ë¦­í•˜ë©´ ì½”ë“œë¥¼ íŒì›¨ì–´ì— ì—…ë¡œë“œ í•  ìˆ˜ ìˆë‹¤.</p><p>ê·¸ í›„ ê°’ì´ ì–´ë–¤ì§€ ë³´ë ¤ë©´ <code class="language-plaintext highlighter-rouge">tools -&gt; serial monitor</code>ì— ë“¤ì•„ê°€ë©´ ì¶œë ¥ì´ ë  ê²ƒì´ë‹¤.</p><p><img data-src="/assets/img/dev/week4/day4/aduino_print.png" data-proofer-ignore></p><p><br /></p><h3 id="ì œì‘ì„-ìœ„í•œ-3ë‹¨ê³„---ë¦¬ëˆ…ìŠ¤-í”„ë¡œê·¸ë˜ë°ì´-í•„ìš”í•˜ë‹¤">ì œì‘ì„ ìœ„í•œ 3ë‹¨ê³„ - ë¦¬ëˆ…ìŠ¤ í”„ë¡œê·¸ë˜ë°ì´ í•„ìš”í•˜ë‹¤. <a href="#ì œì‘ì„-ìœ„í•œ-3ë‹¨ê³„---ë¦¬ëˆ…ìŠ¤-í”„ë¡œê·¸ë˜ë°ì´-í•„ìš”í•˜ë‹¤" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>ë¦¬ëˆ…ìŠ¤ ROS</p><ul><li>ì•„ë‘ì´ë…¸ê°€ ë³´ë‚´ì£¼ëŠ” ë¬¼ì²´ê¹Œì§€ì˜ ê±°ë¦¬ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê¸° ì¢‹ì€ í˜•íƒœë¡œ ì ì ˆíˆ ê°€ê³µ<li>ROSí† í”½ì— ë‹´ì•„ í•„ìš”í•œ ë…¸ë“œë“¤ì—ê²Œ Publish</ul><p><br /></p><ul><li>íŒ¨í‚¤ì§€ ìƒì„±</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>xycar_ws
  âŠ¢ build
  âŠ¢ devel
  âˆŸ src
      âˆŸ ultrasonic
          âŠ¢ launch
              âˆŸ ultra.launch
          âˆŸ src
              âŠ¢ ultrasonic_sub.py
              âˆŸ ultrasonic_pub.py
</pre></table></code></div></div><p><br /></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>íŒ¨í‚¤ì§€ ìƒì„±
<span class="nv">$ </span>catkin_create_pkg ultrasonic std_msgs rospy

launch íŒŒì¼ ìƒì„±
ultrasonic<span class="nv">$ </span><span class="nb">mkdir </span>launch

ìƒˆë¡œë§Œë“  íŒ¨í‚¤ì§€ ë¹Œë“œ
<span class="nv">$ </span>cm
</pre></table></code></div></div><p><br /></p><ul><li>ì†ŒìŠ¤ì½”ë“œ ìƒì„± (ultrasonic_pub.py)</ul><p>ì´ˆìŒíŒŒì„¼ì„œê°€ ë³´ë‚¸ ê±°ë¦¬ì •ë³´ë¥¼ í† í”½ì— ë‹´ì•„ publishing</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">import</span> <span class="n">serial</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">rospy</span>
<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">Int32</span>

<span class="n">ser_front</span> <span class="o">=</span> <span class="n">serial</span><span class="p">.</span><span class="nc">Serial</span><span class="p">(</span> 
    <span class="n">port</span><span class="o">=</span><span class="s">'/dev/ttyUSB0'</span><span class="p">,</span> <span class="c1"># ì•„ë‘ì´ë…¸ê°€ ì—°ê²°ëœ í¬íŠ¸
</span>    <span class="n">baudrate</span><span class="o">=</span><span class="mi">9600</span><span class="p">,</span>       <span class="c1"># ì•„ë‘ì´ë…¸ì—ì„œ ì„ ì–¸í•œ í†µì‹  ì†ë„
</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">read_sensor</span><span class="p">():</span>
    <span class="n">serial_data</span> <span class="o">=</span> <span class="n">ser_front</span><span class="p">.</span><span class="nf">readline</span><span class="p">()</span> <span class="c1"># ì‹œë¦¬ì–¼ í¬íŠ¸ë¡œ ë“¤ì–´ì˜¨ ë°ì´í„°ë¥¼ ë°›ì•„ì˜´
</span>    <span class="n">ser_front</span><span class="p">.</span><span class="nf">flushInput</span><span class="p">()</span>  <span class="c1"># ì¤‘ê°„ì— ë²„í¼ë“¤ì´ ìˆì–´ì„œ ê·¸ë¥¼ ì‚­ì œí•´ì£¼ëŠ” flush
</span>    <span class="n">ser_front</span><span class="p">.</span><span class="nf">flushOutput</span><span class="p">()</span>
    <span class="n">ultrasonic_data</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">filter</span><span class="p">(</span><span class="nb">str</span><span class="p">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="n">serial_data</span><span class="p">))</span> <span class="c1"># stringì„ ìˆ«ìë¡œ ë³€í™˜
</span>    <span class="n">msg</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">ultrasonic_data</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="s">'ultrasonic_pub'</span><span class="p">,</span> <span class="n">anonymous</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">pub</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Publisher</span><span class="p">(</span><span class="s">'ultrasonic'</span><span class="p">,</span> <span class="n">Int32</span><span class="p">,</span> <span class="n">queue_size</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="nc">Int32</span><span class="p">()</span>
    
    <span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="p">.</span><span class="nf">is_shutdown</span><span class="p">():</span>
        <span class="nf">read_sensor</span><span class="p">()</span> <span class="c1"># ì‹œë¦¬ì–¼í¬íŠ¸ì—ì„œ ì„¼ì„œê°€ ë³´ë‚´ì¤€ ë¬¸ìì—´ ì½ì—‡ê±° ê±°ë¦¬ ì •ë³´ ì¶”ì¶œ
</span>        <span class="n">pub</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>    
        <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span> <span class="c1"># í† í”½ì— ë‹´ì•„ì„œ publish
</span>
    <span class="n">ser_front</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># ëë‚˜ë©´ ì‹œë¦¬ì–¼í¬íŠ¸ ë‹«ê¸°
</span></pre></table></code></div></div><ul><li>ì¶”ê°€ë¡œ ê²€ì¦ìš©ìœ¼ë¡œ ì‚¬ìš©í•  subscriber ë…¸ë“œë„ ìƒì„± (ultrasonic_sub.py)</ul><p>publishì˜ ë©”ì‹œì§€ë¥¼ ë°›ì•„ ì¶œë ¥í•œë‹¤.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">import</span> <span class="n">rospy</span>
<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">Int32</span>

<span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="s">'ultrasonic_sub'</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Subscriber</span><span class="p">(</span><span class="s">'ultrasonic'</span><span class="p">,</span> <span class="n">Int32</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

<span class="n">rospy</span><span class="p">.</span><span class="nf">spin</span><span class="p">()</span>
</pre></table></code></div></div><ul><li>ì‹¤í–‰ì„ ìœ„í•œ launch íŒŒì¼ ë§Œë“¤ê¸°</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- ultra.launch --&gt;</span>
<span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"ultrasonic"</span> <span class="na">type=</span><span class="s">"ultrasonic_pub.py"</span> <span class="na">name=</span><span class="s">"ultrasonic_pub"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"ultrasonic"</span> <span class="na">type=</span><span class="s">"ultrasonic_sub.py"</span> <span class="na">name=</span><span class="s">"ultrasonic_sub"</span> <span class="na">output=</span><span class="s">"screen"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></table></code></div></div><p><br /></p><ul><li>ì‹¤í–‰</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>roslaunch ultrasonic ultra.launch
</pre></table></code></div></div><p>ì‹¤í–‰í•˜ë©´ ì´ˆìŒíŒŒì„¼ì„œì˜ ë°ì´í„°ê°€ ìˆ«ìë§Œ ì¶œë ¥í•˜ê²Œ ë  ê²ƒì´ë‹¤.</p><p><br /></p><h3 id="ì´ˆìŒíŒŒ-ì„¼ì„œ-4ê°œë¥¼-ì§€ì›í•˜ëŠ”-ros-íŒ¨í‚¤ì§€-ì œì‘í•˜ê¸°">ì´ˆìŒíŒŒ ì„¼ì„œ 4ê°œë¥¼ ì§€ì›í•˜ëŠ” ROS íŒ¨í‚¤ì§€ ì œì‘í•˜ê¸° <a href="#ì´ˆìŒíŒŒ-ì„¼ì„œ-4ê°œë¥¼-ì§€ì›í•˜ëŠ”-ros-íŒ¨í‚¤ì§€-ì œì‘í•˜ê¸°" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>ì´ˆìŒíŒŒì„¼ì„œ 4ê°œë¥¼ í”„ë¡œì„¸ì„œë³´ë“œë¡œ ì—°ê²°í•´ì•¼ í•œë‹¤. ê·¸ëŸ¬ë ¤ë©´ íŒì›¨ì–´(ì•„ë‘ì´ë…¸)ë¥¼ ì¡°ì •í•˜ê³ , ROSê´€ì ì—ì„œëŠ” 4ê°œì˜ ë°©í–¥ì´ ìˆìœ¼ë¯€ë¡œ 4ê°œë¥¼ ë°œí–‰í•´ì¤˜ì•¼ í•œë‹¤.</p><p>ë…¸ë“œëŠ” <code class="language-plaintext highlighter-rouge">/ultra4_pub</code>ë¡œ í•˜ê³ , í† í”½ì€ <code class="language-plaintext highlighter-rouge">/ultra4</code>, ë©”ì‹œì§€ íƒ€ì…ì€ <code class="language-plaintext highlighter-rouge">Int32MultiArray</code>ë¡œ í•œë‹¤.</p><p><br /></p><p>ultrasoinc_fw.inoë¥¼ ìˆ˜ì •í•˜ì—¬ <code class="language-plaintext highlighter-rouge">ultrasonic_4_fw.ino</code> íŒŒì¼ ì‘ì„±í•œë‹¤. ê° ì„¼ì„œì˜ Vcc,Trig,Echo,Gndë¥¼ ê° í•€ì— ì—°ê²°í•œë‹¤. ê° ì„¼ì„œë¥¼ ì—°ê²°í•˜ì—¬ 5V, Gndë¥¼ ì•„ë‘ì´ë…¸ ë³´ë“œì— ì—°ê²°í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ê°ê° ì•„ë‘ì´ë…¸ ë³´ë“œì— ì—°ê²°í•œë‹¤.</p><p>ê±°ë¦¬ì •ë³´ëŠ” <code class="language-plaintext highlighter-rouge">300mm 121mm 186mm 67mm</code> ì˜ í˜•íƒœë¡œ 4ê°œë¥¼ ì „ì†¡í•œë‹¤.</p><p><br /></p><p>ê¸°ì¡´ì— ì‚¬ìš©í–ˆë˜ ultrasonic íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ <code class="language-plaintext highlighter-rouge">ultra4.launch</code>, <code class="language-plaintext highlighter-rouge">ultra4_pub.py</code>, <code class="language-plaintext highlighter-rouge">ultra4_sub.py</code> , 3ê°œì˜ íŒŒì¼ì„ ìƒì„±í•œë‹¤.</p><ul><li>ultra4_pub.py</ul><p>ì´ˆìŒíŒŒ ì„¼ì„œê°€ ë³´ë‚¸ ê±°ë¦¬ì •ë³´ë¥¼ í† í”½ì— ë‹´ì•„ publishingí•œë‹¤</p><ol><li>ì•„ë‘ì´ë…¸ê°€ ì—°ê²°ëœ í¬íŠ¸ ì§€ì • (usb í¬íŠ¸ëŠ” ë¦¬ëˆ…ìŠ¤ê°€ ê´€ë¦¬í•˜ê¸°ì— ë¦¬ëˆ…ìŠ¤ì—ê²Œ ìš”ì²­)<li>def read_sensor() ìƒì„±(ì‹œë¦¬ì–¼ ë°ì´í„° í•œë²ˆì— ë¬¸ìì—´ë¡œ ë°›ì•„ì˜¤ê³  ë¬¸ìì—´ì—ì„œ ìˆ«ì 4ê°œë¥¼ ì¶”ì¶œí•˜ì—¬ ë¦¬ìŠ¤íŠ¸ì— ë‹´ëŠ”ë‹¤.)<li>mainí•¨ìˆ˜ (ultra4_pub ë…¸ë“œ ìƒì„±, ultra4 í† í”½ ë°œí–‰, whileë¬¸(ì•„ë‘ì´ë…¸ì—ê²Œ ì •ë³´ë¥¼ ë°›ì•„ì™€ì„œ í† í”½ì•ˆì— ì˜ ì±„ì›Œë„£ì–´ í† í”½ì„ ë°œí–‰), ì‹œë¦¬ì–¼ì„ ë‹«ê³  ì •ë¦¬)</ol><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">Serial</span>
<span class="p">...</span>

<span class="n">FRONT</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="n">ser_front</span> <span class="o">=</span> <span class="n">serial</span><span class="p">.</span><span class="nc">Serial</span><span class="p">(</span>  <span class="c1"># ì•„ë‘ì´ë…¸ê°€ ì—°ê²°ëœ í¬íŠ¸ ì§€ì •
</span>    <span class="n">port</span><span class="o">=</span><span class="s">'/dev/ttyUSB0'</span><span class="p">,</span>
    <span class="n">baudrate</span><span class="o">=</span><span class="mi">9600</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">read_sensor</span><span class="p">():</span>
    <span class="n">sersor_data</span> <span class="o">=</span> <span class="n">ser_front</span><span class="p">.</span><span class="nf">readline</span><span class="p">()</span>
    <span class="n">ser_front</span><span class="p">.</span><span class="nf">flushInput</span><span class="p">()</span>
    <span class="n">ser_front</span><span class="p">.</span><span class="nf">flushOutput</span><span class="p">()</span>
    <span class="n">FRONT</span> <span class="o">=</span> <span class="nf">read_Sdata</span><span class="p">(</span><span class="n">sensor_data</span><span class="p">)</span>
    <span class="n">msg</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">FRONT</span>

<span class="k">def</span> <span class="nf">read_Ssdata</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
    <span class="n">s_data</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">"mm"</span><span class="p">)</span>
    <span class="n">s_data</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="s">'</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">s_data</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">s_data</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">s_data</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="p">...</span>
    <span class="n">ser_front</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</pre></table></code></div></div><p><br /></p><ul><li>ultra4_sub.py</ul><p>publisherì˜ ë©”ì‹œì§€ë¥¼ ë°›ì•„ ì¶œë ¥í•œë‹¤.</p><ol><li>í† í”½ì—ì„œ ë°ì´í„°ë¥¼ êº¼ë‚´ì„œ ì¶œë ¥<li>ultra4_sub ë…¸ë“œ ìƒì„±<li>ultra4 í† í”½ êµ¬ë… ì¤€ë¹„<li>ultra4 í† í”½ì„ ë°›ìœ¼ë©´ callback í˜¸ì¶œ<li>ë¬´í•œ ë£¨í”„</ol><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">import</span> <span class="n">rospy</span>
<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">Int32</span>

<span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="s">'ultrasonic_sub'</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Subscriber</span><span class="p">(</span><span class="s">'ultrasonic'</span><span class="p">,</span> <span class="n">Int32</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

<span class="n">rospy</span><span class="p">.</span><span class="nf">spin</span><span class="p">()</span>
</pre></table></code></div></div><p><br /></p><ul><li>ultra4.launch</ul><ol><li>í† í”½ì˜ ë°œí–‰ì ì‹¤í–‰<li>í† í”½ì˜ êµ¬ë…ì ì‹¤í–‰</ol><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"ultrasonic"</span> <span class="na">type=</span><span class="s">"ultrasonic_pub.py"</span> <span class="na">name=</span><span class="s">"ultrasonic_pub"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"ultrasonic"</span> <span class="na">type=</span><span class="s">"ultrasonic_sub.py"</span> <span class="na">name=</span><span class="s">"ultrasonic_sub"</span> <span class="na">output=</span><span class="s">"screen"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span> 
</pre></table></code></div></div><p><br /></p><p>ì‹¤í–‰</p><ol><li>ì—°ê²° í™•ì¸</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>lsusb
~~~~~~ HL-340 USB~~~
</pre></table></code></div></div><ol><li>íŒì›¨ì–´ í”„ë¡œê·¸ë˜ë°</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>arduino
</pre></table></code></div></div><ol><li>ì•„ë‘ì´ë…¸ê°€ ì—°ê²°ëœ ë¦¬ëˆ…ìŠ¤ í¬íŠ¸ í™•ì¸</ol><p>toolsë©”ë‰´ì—ì„œ Board/Processor Portë¥¼ ì²´í¬í•´ì•¼ í•œë‹¤.</p><ul><li>board : Arduino Nano<li>Processor : Atmega328P<li>Port : /dev/ttyUSB0 or /dev/ttyACM0</ul><ol><li>ì•„ë‘ì´ë…¸ íŒì›¨ì–´ ì†ŒìŠ¤ì½”ë“œ</ol><p>ì´ˆìŒíŒŒì„¼ì„œê°€ ë³´ë‚´ëŠ” ì‹ í˜¸ë¡œë¶€í„° ê±°ë¦¬ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” ì†ŒìŠ¤ì½”ë“œë‹¤.</p><pre><code class="language-arduino">int trig[4] = {2,4,6,8}; // ì„¼ì„œë¥¼ ê¼½ì•˜ë˜ í¬íŠ¸ ë²ˆí˜¸
int echo[4] = {3,5,7,9}; //
int i=0;

void setup() {
    Serial.begin(9600);
    for(i=0;i&lt;4;i++) {
        pinMode(trig[i],OUTPUT);    // TRIG í•€ì„ ì¶œë ¥ëª¨ë“œë¡œ ì„¸íŒ…
        pinMode(echo[i], INPUT);    // ECHO í•€ì„ ì…ë ¥ëª¨ë“œë¡œ ì„¸íŒ…
    }
}

void loop() {
    long dur[4]={0.0,};
    long dist[4]={0.0,};

    for(i=0; i&lt;4; i++) {
        digitalWrite(trig[i],LOW);
        delayMicroseconds(2);
        digitalWrite(trig[i],HIGH);         // trig ì‹ í˜¸ë¥¼ high ìƒíƒœë¡œ ë³€ê²½
        delayMicroseconds(10);              // 10ë§ˆì´í¬ë¡œì´ˆ ëŒ€ê¸°
        digitalWrite(trig[i],LOW);          // Trig ì‹ í˜¸ë¥¼ low ìƒíƒœë¡œ ë³€ê²½

        dur[i] = pulseIn(echo[i],HIGH);     // Echo í„ìŠ¤ì—ì„œ ì™•ë³µì‹œê°„ì„ ê³„ì‚°í•´ì„œ ì €ì¥
        dist[i] = dur[i]*170/1000;          // ì‹œê°„ì„ ì´ë™ê±°ë¦¬ë¡œ í™˜ì‚°í•´ì„œ ì €ì¥
        if(dist[i]&gt;=2000 || dist[i]&lt;0) {    // ê±°ë¦¬ê°€ 200cmì´ìƒì´ê±°ë‚˜ 0ë³´ë‹¤ ì‘ìœ¼ë©´ 0ìœ¼ë¡œ ì„¤ì •
            dist[i]=0;
        }
    }

    Serial.print(dist[0]); //dist[0] ì¶œë ¥
    Serial.print("mm ");
    Serial.print(dist[1]);
    Serial.print("mm ");
    Serial.print(dist[2]);
    Serial.print("mm ");
    Serial.print(dist[3]);
    Serial.print("mm ");

    delay(50);
}
</code></pre><ol><li>ì»´íŒŒì¼ &amp; ì—…ë¡œë“œ</ol><p>ì»´íŒŒì¼ ë° ì—…ë¡œë“œë¥¼ ì§„í–‰í•œë‹¤.</p><ol><li>ê²°ê³¼ í™•ì¸</ol><p>ì‹œë¦¬ì–¼ ëª¨ë‹ˆí„°ë¥¼ ì´ìš©í•´ì„œ ì•„ë‘ì´ë…¸ì˜ ì¶œë ¥ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. tools -&gt; serial Monitor</p><ol><li>ì‹¤í–‰</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>roslaunch ultrasonic ultra4.launch
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div style="text-align: left;"> <a href="http://hits.dwyl.com/dkssud8150.github.io/posts/lidar1/" target="_blank"> <img data-src="http://hits.dwyl.com/dkssud8150.github.io/posts/lidar1.svg" data-proofer-ignore> </a></div><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/classlog/'>Classlog</a>, <a href='/categories/devcourse/'>devcourse</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ros/" class="post-tag no-text-decoration" >ros</a> <a href="/tags/urdf/" class="post-tag no-text-decoration" >urdf</a> <a href="/tags/rviz/" class="post-tag no-text-decoration" >rviz</a> <a href="/tags/devcourse/" class="post-tag no-text-decoration" >devcourse</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS nodes and topics for lidar sensors - JaeHo Yoon&amp;url=https://dkssud8150.github.io/posts/lidar1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS nodes and topics for lidar sensors - JaeHo Yoon&amp;u=https://dkssud8150.github.io/posts/lidar1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://dkssud8150.github.io/posts/lidar1/&amp;text=[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS nodes and topics for lidar sensors - JaeHo Yoon" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://dkssud8150.github.io/posts/lidar1/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6611243953442169" crossorigin="anonymous"></script></div><script src="https://utteranc.es/client.js" repo="dkssud8150/dkssud8150.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/gitpage/">[ê¹ƒí—ˆë¸Œ í”„ë¡œí•„ ê¾¸ë¯¸ê¸°] github í”„ë¡œí•„ ë§Œë“¤ê¸°</a><li><a href="/posts/product/">[ê¹ƒí—ˆë¸Œ í”„ë¡œí•„ ê¾¸ë¯¸ê¸°] productive box ë§Œë“¤ê¸°</a><li><a href="/posts/regex/">[ë°ë¸Œì½”ìŠ¤] 2ì£¼ì°¨ - linux ê¸°ì´ˆ(REGEX)</a><li><a href="/posts/Kfold/">KFold Cross Validation ê³¼ StratifiedKFold</a><li><a href="/posts/cmake/">[ë°ë¸Œì½”ìŠ¤] 17ì£¼ì°¨ - CMake OpenCV, Eigen, Pangolin install </a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/devcourse/">devcourse</a> <a class="post-tag" href="/tags/deeplearning/">deeplearning</a> <a class="post-tag" href="/tags/cs231n/">CS231N</a> <a class="post-tag" href="/tags/ros/">ros</a> <a class="post-tag" href="/tags/coding-test/">coding test</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/kooc/">kooc</a> <a class="post-tag" href="/tags/opencv/">OpenCV</a> <a class="post-tag" href="/tags/pytorch-tutorial/">pytorch tutorial</a> <a class="post-tag" href="/tags/autonomous-driving/">Autonomous Driving</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/sensordriving/"><div class="card-body"> <em class="timeago small" date="2022-03-11 16:14:00 +0900" >Mar 11, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS Self-driving using sensors</h3><div class="text-muted small"><p> ë¼ì´ë‹¤ë¥¼ í†µí•œ ì¥ì• ë¬¼ íšŒí”¼ lidar_drive íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš© lidar_gostop.py , lidar_gostop.launch 1 2 3 4 5 6 &amp;lt;!-- lidar_gostop.launch --&amp;gt; &amp;lt;launch&amp;gt; &amp;lt;include file=&quot;$(find xycar_motor)/launch/xyc...</p></div></div></a></div><div class="card"> <a href="/posts/rviz/"><div class="card-body"> <em class="timeago small" date="2022-03-08 19:00:00 +0900" >Mar 8, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS auto driving using Sensor</h3><div class="text-muted small"><p> RVIZ ê¸°ë°˜ ì˜¤ë„ë©”íŠ¸ë¦¬ í™œìš© odometry ì˜¤ë„ë¯¸í„°(odometry): ì°¨ëŸ‰ì´ë‚˜ ë¡œë´‡ì´ ì£¼í–‰í•˜ë©° ì´ë™í•œ ê±°ë¦¬ë¥¼ ì¸¡ì •í•˜ëŠ” ê¸°ê¸° ì˜¤ë„ë©”íŠ¸ë¦¬(odomerty): ì˜¤ë„ë¯¸í„° ë“±ì˜ ê¸°ê¸°ì˜ ì¸¡ì •ê°’ìœ¼ë¡œ ì›€ì§ì´ëŠ” ì‚¬ë¬¼ì˜ ìœ„ì¹˜ë¥¼ ì¸¡ì •í•˜ëŠ” ë°©ë²• ìë™ì°¨ì˜ ì´ë™ê±°ë¦¬ëŠ” ë°”í€´ì˜ íšŒì „ìˆ˜ë¡œ ê³„ì‚°í•œë‹¤. í•¸ë“¤ì„ êº½ì„ ë•Œ ì• ë°”í€´ ë‘ê°œê°€ ì„œë¡œ ë‹¤ë¥´ë‹¤. ì´ìœ ...</p></div></div></a></div><div class="card"> <a href="/posts/urdf/"><div class="card-body"> <em class="timeago small" date="2022-03-10 01:47:00 +0900" >Mar 10, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS 3d modeling of Car based on urdf</h3><div class="text-muted small"><p> URDFë€? URDF (Unified Robot Description Format) ë€ ë¡œë´‡ì˜ 3D í˜•ìƒ ë° ì™¸ê´€, ê´€ì„± ë“± ë¬¼ë¦¬ì  íŠ¹ì„± ë“±ì„ XML ì–¸ì–´ë¡œ ì •ì˜í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. URDFë¡œ ì •ì˜ëœ ë¡œë´‡ ëª¨ë¸ì€ RVIZì—ì„œ 3ì°¨ì›ìœ¼ë¡œ ë³´ê±°ë‚˜ Gazeboì—ì„œ ë¬¼ë¦¬ ì‹œë®¬ë ˆì´ì…˜ì´ ê°€ëŠ¥í•˜ë‹¤. URDF ì¢Œí‘œê³„ ë° ë‹¨ìœ„ ì¢Œí‘œê³„ ìœ„ì¹˜ë‚˜ í¬ê¸°ë¥¼...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/urdf/" class="btn btn-outline-primary" prompt="Older"><p>[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - ROS 3d modeling of Car based on urdf</p></a> <a href="/posts/filter/" class="btn btn-outline-primary" prompt="Newer"><p>[ë°ë¸Œì½”ìŠ¤] 4ì£¼ì°¨ - Understanding and Using Filters</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2023 <a href="https://twitter.com/username">JaeHo YooN</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/devcourse/">devcourse</a> <a class="post-tag" href="/tags/deeplearning/">deeplearning</a> <a class="post-tag" href="/tags/cs231n/">CS231N</a> <a class="post-tag" href="/tags/ros/">ros</a> <a class="post-tag" href="/tags/coding-test/">coding test</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/kooc/">kooc</a> <a class="post-tag" href="/tags/opencv/">OpenCV</a> <a class="post-tag" href="/tags/pytorch-tutorial/">pytorch tutorial</a> <a class="post-tag" href="/tags/autonomous-driving/">Autonomous Driving</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-NC7MWHVXJE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NC7MWHVXJE'); }); </script>