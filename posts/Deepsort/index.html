<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Simple Online and Realtime Tracking With a Deep Association Metric" /><meta name="author" content="JaeHo-YooN" /><meta property="og:locale" content="en" /><meta name="description" content="Deep Sort에 대한 논문을 리뷰한 내용입니다. 혼자 공부하기 위해 정리한 내용으로 이해가 안되는 부분들이 많을 거라 생각됩니다. 참고용으로만 봐주세요." /><meta property="og:description" content="Deep Sort에 대한 논문을 리뷰한 내용입니다. 혼자 공부하기 위해 정리한 내용으로 이해가 안되는 부분들이 많을 거라 생각됩니다. 참고용으로만 봐주세요." /><link rel="canonical" href="https://dkssud8150.github.io/posts/Deepsort/" /><meta property="og:url" content="https://dkssud8150.github.io/posts/Deepsort/" /><meta property="og:site_name" content="JaeHo Yoon" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-08T13:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Simple Online and Realtime Tracking With a Deep Association Metric" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@JaeHo-YooN" /><meta name="google-site-verification" content="znvuGsQGYxMZPBslC4XG6doCYao6Y-fWibfGlcaMHH8" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"JaeHo-YooN"},"dateModified":"2022-05-02T19:02:11+09:00","datePublished":"2021-09-08T13:00:00+09:00","description":"Deep Sort에 대한 논문을 리뷰한 내용입니다. 혼자 공부하기 위해 정리한 내용으로 이해가 안되는 부분들이 많을 거라 생각됩니다. 참고용으로만 봐주세요.","headline":"Simple Online and Realtime Tracking With a Deep Association Metric","mainEntityOfPage":{"@type":"WebPage","@id":"https://dkssud8150.github.io/posts/Deepsort/"},"url":"https://dkssud8150.github.io/posts/Deepsort/"}</script><title>Simple Online and Realtime Tracking With a Deep Association Metric | JaeHo Yoon</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="JaeHo Yoon"><meta name="application-name" content="JaeHo Yoon"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/shin_chan.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">JaeHo Yoon</a></div><div class="site-subtitle font-italic">Mamba Mentality</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fab fa-angellist ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/dkssud8150" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hoya58150','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.notion.so/18490713817d403696812c57d0abe730" aria-label="notion" target="_blank" rel="noopener"> <i class="fab fa-battle-net"></i> </a> <a href="https://www.linkedin.com/in/jaeho-yoon-90b62b230" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.instagram.com/jai_ho8150/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Simple Online and Realtime Tracking With a Deep Association Metric</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 500'%3E%3C/svg%3E" data-src="/assets/img/tracking/deepSort.jpg" class="preview-img bg" alt="Preview Image" width="800" height="500" data-proofer-ignore><h1 data-toc-skip>Simple Online and Realtime Tracking With a Deep Association Metric</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/dkssud8150">JaeHo-YooN</a> </em></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6611243953442169" crossorigin="anonymous"></script><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-09-08 13:00:00 +0900" data-toggle="tooltip" data-placement="bottom" title="Wed, Sep 8, 2021, 1:00 PM +0900" >Sep 8, 2021</em> </span> <span> Updated <em class="timeago" date="2022-05-02 19:02:11 +0900 " data-toggle="tooltip" data-placement="bottom" title="Mon, May 2, 2022, 7:02 PM +0900" >May 2, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3895 words"> <em>21 min</em> read</span></div></div></div><div class="post-content"><p>Deep Sort에 대한 논문을 리뷰한 내용입니다. 혼자 공부하기 위해 정리한 내용으로 이해가 안되는 부분들이 많을 거라 생각됩니다. 참고용으로만 봐주세요.</p><h2 id="abstract">Abstract <a href="#abstract" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>SORT 는 간단하고 효과적인 알고리즘에 초점을 맞춘 Multiple Object Tracking 에 대한 실용적인 접근이다. 하지만 평가 불확실성(estimation uncertainty)이 낮을 때만 association metric이 정확하여 객체가 계속 스위칭 되는 현상이 있었다. 즉, (가려짐)occlusion에 취약했다.</p><p>본 논문에서는 SORT 의 성능을 향상시키기 위해 appearance information 즉, 외형 정보를 통합한다. 이를 통해, 더 긴 기간동안 가려졌던 물체를 추적하고, ID 스위칭 수를 줄일 수 있다.</p><p>또한, 복잡한 계산을 offline pretraining 단계에 배치하여, 큰 스케일의 person re-identification dataset 에서 deep association metric을 학습한다.</p><p>online을 적용하면서, visual appearance 에 대해 nearest neighbor를 사용하여 measurement-to-track association을 만들었다.</p><p>실험을 통해 ID 스위칭 수가 45%까지 감소할 수 있었고, 높은 프레임률로 좋은 성능을 달성했다.</p><blockquote><p>이때, <code class="language-plaintext highlighter-rouge">online</code> 과 <code class="language-plaintext highlighter-rouge">offline</code> 학습의 차이는</p><ul><li>online: mini batch라 부르는 작은 묶음 단위로 훈련한다. 연속적으로 데이터를 받고 빠른 변화에 스스로 적응해야 하는 시스템에 적합하다.<li>offline : 가용한 데이터를 모두 사용해 훈련시킨다. 시간과 자원을 많이 소모하기 때문에 오프라인에서 가동된다. 시스템을 훈련시키고 적용하면 더 이상 학습 없이 실행 가능하다. 하지만 새로운 데이터에 대해 학습하려면 전체 데이터를 사용하여 시스템의 새로운 버전을 만들어 처음부터 다시 훈련해야 한다.</ul></blockquote><h2 id="introduction">Introduction <a href="#introduction" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>최근 object detection의 진보로 인해, tracking-by-detection은 Multiple Object Tracking에서 앞서나가는 패러다임이 되었다.</p><p>이 패러다임에는 객체 궤적은 보통 전체 video batch들을 한 번에 처리하는 전역 최적화 문제(global optimization problem)가 존재했다. 이 batch processing 때문에, 이 방법은 각 시간마다 대상 ID가 반드시 이용가능해야 하는 온라인 방식에는 적용될 수 없었다.</p><p>전통적인 방법인 MHT(Multiple Hypothesis Tracking) 과 JPDAF(Joint Probabilistic Data Association Filter)은 frame-by-frame 방식을 사용하여 data association을 수행한다.</p><p>JPDAF에서 단일 state hypothesis 는 data association 에 따라 개별 측정값에 가중치를 부여하여 발생된다. 또, MHT에서는 가능한 모든 hypotheis를 추적하지만 계산 추적성을 위해 pruning schemes를 적용해야 한다. 두 방법은 최근 tracking-by-detection 에서 재검토되어 좋은 결과를 보여줬다.</p><p>하지만, 두 방법의 성능은 계산 및 구현 복잡성을 증가시키게 된다.</p><p>SORT는 이미지 공간에서 kalman filtering을 수행하고 bounding box overlap을 측정하는 association metric과 함께 Hungarian method를 사용하여 frame-by-frame data association을 수행하는 간단한 프레임워크다. 이 간단한 방법은 높은 프레임율을 달성했다.</p><p>MOT challenge dataset에서, <code class="language-plaintext highlighter-rouge">최첨단 detector</code>가 있는 SORT가 표준 detector의 MHT보다 높은 순위를 차지한다.</p><p><img data-src="https://blog.kakaocdn.net/dn/Ibv1D/btqZV6sNB8Z/XT4qYuaPe8bbhns4FpIS1K/img.png" alt="iamge" data-proofer-ignore></p><p>이유는 지난 번 리뷰에도 봤듯이 좋은 detector 가 좋은 tracking 성능을 만들기 때문이다.</p><p>SORT는 tracking precision 과 accuracy 측면에서 전반적으로 우수한 성능을 보이지만, 상대적으로 높은 ID(identity) 스위칭을 반환한다. SORT에 사용된 association metric이 상태 추정 불확실성(state estimation uncertainty)이 낮을 때만 정확하기 때문이다.</p><p>또한, SORT는 일반적으로 전면 카메라 장면에서 나타나기 때문에 occlusion을 추적하는 데 결함이 있다.</p><p>그래서 data association을 <strong>motion과 appearance information을 결합</strong>하여 더 많은 정보를 가진 metric으로 대체함으로써 이 문제를 해결한다.</p><p>특히 large-scale의 person re-identification dataset에서, 보행자(pedestrians)를 식별하도록 훈련된 <code class="language-plaintext highlighter-rouge">CNN</code>(Convolutional Neural Network)을 적용하고자 한다.</p><p><code class="language-plaintext highlighter-rouge">CNN</code>을 통해 시스템을 구현하기 쉽고 효율적이며 온라인 방식에 적용할 수 있도록 유지하면서 오류와 occlusion에 대해 견고함을 향상시켰다.</p><h2 id="sort-with-deep-association-metrics">SORT with Deep Association Metrics <a href="#sort-with-deep-association-metrics" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>본 논문에서는 반복적인 Kalman filtering과 frame-by-frame data association을 가진 single hypothesis tracking 방법을 선택한다.</p><p>이 시스템의 핵심 구성 요소에 대해 설명하고자 한다.</p><h3 id="track-handling-and-state-estimation">Track Handling and State Estimation <a href="#track-handling-and-state-estimation" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>SORT와 동일하게 등속 운동과 선형 관측 모델이 있는 kalman fiter와 Hungarian algorithm을 사용하지만, state space의 형태가 달라졌다. 카메라가 보정되지 않은 상태거나 이용할 수 있는 ego-motion information이 없는 일반적인 tracking 시나리오로 가정한다.</p><p>이러한 상황은 filter 프레임워크에 문제를 야기하지만, 최근 MOT benchmark에서는 가장 기본적인 설정이다.</p><p><img data-src="https://images.velog.io/images/kimkj38/post/7d6ce166-4698-4014-90a6-4f520057fc22/image.png" alt="image" data-proofer-ignore></p><p>그래서 우리의 tracking 시나리오는 위와 같이 총 8개 차원의 상태 공간으로 정의된다.</p><ul><li><code class="language-plaintext highlighter-rouge">(u,v)</code>: bounding box 의 중심 위치<li><code class="language-plaintext highlighter-rouge">r</code>: 가로 세로 비율<li><code class="language-plaintext highlighter-rouge">h</code>: 높이<li><code class="language-plaintext highlighter-rouge">(x,˙ y,˙ γ,˙ h˙):</code> 이미지 좌표의 속도</ul><p>이미지의 좌표는 object state의 직접 관측을 통해 얻은 값을 사용한다.</p><p>각 track <code class="language-plaintext highlighter-rouge">K</code>는 measurement association 될 때마다 프레임의 수를 카운트되며, 이 카운트는 kalman filter prediction하는 동안에 증가되고, track이 measurement와 연결되면 0으로 재설정된다.</p><p>사전정의된 Max age 보다 오래 매칭되지 않은 track은 화면을 떠난 것으로 간주되어 삭제한다.</p><p>기존 트랙과 연관(association)될 수 없는 각 detection에 대해서는 새로운 track 가설(hypothesis)를 시작한다. 이 새로운 track은 처음 3번의 프레임까지는 잠정적(tentative) 상태로 분류하여 매칭되지 않아도 연관되기 전까지 유지하고, 그래도 안되면 삭제한다.</p><h3 id="assignment-problem">Assignment Problem <a href="#assignment-problem" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>예측된 kalman state와 새로 받은 측정치(measurement) 사이의 연관성(association)을 해결하는 전통적인 방법은 Hungarian algorithm을 사용하여 해결할 수 있는 할당 문제(assignment problem)를 구축하는 것이다.</p><p>이 문제 공식에서 두 가지 적절한 metric의 조합을 통해 motion과 appearance information을 통합한다.</p><p>motion 정보를 통합하기 위해 예측된 kalman state와 새로 받은 측정치 사이의 <code class="language-plaintext highlighter-rouge">Mahalanobis distance</code>를 사용한다.</p><ul><li>Mahalanobis Distance</ul><p><img data-src="https://images.velog.io/images/kimkj38/post/7c7ced1b-ad59-4cf3-be37-b4b4be55b136/image.png" alt="image" data-proofer-ignore></p><ul><li><code class="language-plaintext highlighter-rouge">(yi,Si)</code>: i번째 track distribution에서 측정 space로의 예상치(projection)<li><code class="language-plaintext highlighter-rouge">(dj)</code>: j번째 bounding box detection<li>i번째 track과 j번째 bounding box detection 사이의 거리</ul><p>Mahalanobis distance는 detection이 평균 track location으로부터 표준편차에 대해 얼마나 떨어져 있는지를 측정하여 state estimation uncertainty를 계산하는 것이다.</p><p><img data-src="https://images.velog.io/images/kimkj38/post/3fab630d-7de0-40fd-9d45-dc195db8b3f9/image.png" alt="image" data-proofer-ignore></p><p>이것은 inverse X² 분포의 95% 신뢰구간만 고려하여 해당되지 않는 association은 배제시키는 방법이다.</p><p>i번째 track과 j번째 detection 사이의 연관성이 인정되면 1을 출력한다.</p><p>4차원 measurement space의 경우 Mahalanobis threshold, t(1) = 9.4877 이다.</p><p>Mahlanobis distance 는 motion uncertainty가 낮을 때는 적절한 association metric 가 된다.</p><p>Mahalanobis distance는 short-term prediction에 유용한 움직임에 기초하여 가능한 object location에 대한 정보를 제공한다.</p><p>하지만 kalman filtering 프레임워크에서 얻은 예측 state 분포는 객체 위치의 대략적인 추정치만 제공한다. 특히, 설명되지 않은 카메라 모션으로 인해 이미지 평면에 빠른 변위가 발생할 수 있으므로 이것을 해결하기 위해 Cosine distance를 도입했다.</p><blockquote><p>Mahalanobis distance에 대해 블로그에 있는 것을 추가해보았다. Mahalanobis distance: 평균과의 거리가 표준편차의 몇 배인지를 나타내는 값 <img data-src="https://images.velog.io/images/kimkj38/post/fe0723ce-89c9-4db9-b5cb-3233b841662e/image.png" alt="image" data-proofer-ignore> 위의 그림을 보면 일반적인 거리 개념으로 볼때, a가 μ에 더 가깝다. <img data-src="https://media.vlpt.us/images/kimkj38/post/ba011cfd-131e-489a-be07-7abd6fbf9a39/image.png" alt="image" data-proofer-ignore> 하지만, 데이터들의 평균을 중심으로 데이터의 분산이 가장 큰 방향을 기준으로 축을 잡고 표준편차를 이용하여 계산하게 된다. 이 때 축은 점의 약 68%가 한 단위 내, 95%는 두 단위 내에 분포하도록 단위를 설정한다. 이렇게 설정하면 b가 더 가깝게 설정된다.</p><ul><li>reference : https://kimyo-s.tistory.com/46</ul></blockquote><ul><li>Cosine distance</ul><p><img data-src="/assets/img/2021-09-08/rk.png" alt="image" data-proofer-ignore></p><p>각 bounding box detection dj에 대해 절대값이 1인 appearance descriptor, rj 를 계산한다.</p><p>각 track k에 대해 마지막 100개의 appearance descriptor를 갤러리인 Rk에 보관한다.</p><p><img data-src="/assets/img/2021-09-08/min.png" alt="image" data-proofer-ignore></p><p>appearance descriptor는 사전 훈련된 CNN을 통해 구한다. 이것에 대해서는 section 2.4에 더 자세히 설명하겠다.</p><p>그리고 나서, 이 두번째 측정지표는 appearance space에서 i번째 track과 j번째 detection 사이의 제일 작은 cosine distance를 구한다.</p><p>또, 측정 지표에 따라 연관성이 허용되는지에 대한 여부를 나타내는 이진 변수를 소개한다.</p><p><img data-src="/assets/img/2021-09-08/bij.png" alt="image" data-proofer-ignore></p><p><br /></p><p>cosine distance는 움직임이 덜 차별적인(discriminative)한 경우 long-term occlusion 후 ID(identity)를 회복하는데에 유용한 appearance 정보를 다룬다.</p><p><br /></p><p>따라서, 위의 두 distance를 결합하면 두 지표가 서로 다른 assignment 문제를 처리함으로써 상호 보완된다.</p><p><img data-src="https://images.velog.io/images/kimkj38/post/6cb2c1b9-5424-4aa0-9855-f69c62c6dad8/image.png" alt="image" data-proofer-ignore></p><p>assignment problem을 구축하기 위해 두 metric를 가중치를 주면서 합한다.</p><p><img data-src="https://images.velog.io/images/kimkj38/post/818b61c3-b0b8-4e71-814b-e7aa5f606c98/image.png" alt="image" data-proofer-ignore></p><p>두 측정지표의 gating 영역 내에 있을 경우 연관성이 있다고 인정된다.</p><p>실험에서 보면 Camera motino이 클 때 ⋋ = 0 으로 설정하는 것이 효과가 좋았기에, 이때는 Mahalanobis, d⑴은 gating(연관성 cost)에만 사용된다.</p><ul><li>Matching Cascade</ul><p>전역 할당 문제(global assignment problem)에서 measurement-to-track association을 해결하기보단, 이 문제를 해결하기 위해 cascade를 도입했다.</p><p>물체가 오랫동안 가려지면 kalman filter는 uncertainty를 증가시켜 확률분포는 퍼지는 모양을 보인다.</p><p>이 때, Mahalanobis distance는 어떤 detection에 대해서도 표준편차로 계산한 거리가 작아지기 때문에 uncertainty가 높은 것을 선호한다.</p><p>하지만 이것은 바람직하지 않기 때문에 더 적은 수명을 갖는, 즉 uncertainty가 작은 track에게 우선순위를 부여한다. 부여하는 방법으로 matching cascade를 도입했다.</p><p><img data-src="https://images.velog.io/images/kimkj38/post/8214dd5f-d0b4-48d1-af00-aab90d3dd5f6/image.png" alt="image" data-proofer-ignore></p><blockquote><p>1.detection과 track 사이의 cost matrix 계산 2.detection과 track 사이에서 cost를 기반으로 threshold를 적용하기 위한 마스크 만들기 3.mask matrix 초기화 4.unmatched detection에 대한 matrix를detection으로 초기화(매칭 시 제거) 5.나이가 증가하는 트랙에 대한 선형 할당 문제를 해결하기 위해 모든 age에 대해 for문을 진행 6.마지막 n개 프레임에서 detection이랑 associate 되지 않은 track Tn의 부분집합을 선택 7.Tn안의 track과, 매칭되지 않은 detection <em>U</em> 사이의 최소 cost를 구해서 매칭 8.마스크의 threshold를 적용한 후 match matrix에 넣기 9.조건에 따라 unmatched matrix를 제외시킨다. 10.match matrix와 unmatched matrix를 return 한다.</p></blockquote><p>위 과정을 거친 후 age==1인 unmatched and unconfirmed tracks와 unmatched detection 사이의 IoU association을 적용한다. 갑작스러운 appearance change를 구하는데 도움을 주기 때문이다.</p><ul><li>Deep Appearance Descriptor</ul><p>간단한 nearest neighbor 방법을 사용하면서, 위의 방법들을 성공적으로 수행시키기 위해서는 실제 online tracking application을 하기 전에, offline에서 훈련을 통해 특징을 잘 구별할 수 있도록 만들어야 한다.</p><p>이를 위해 우리는 1261명의 보행자에 대한 11만 개 이상의 이미지를 포함하는 large-scale re-identification dataset(MARS)에 대해 pretraine된 CNN을 사용한다.</p><p>이것이 곧 deep metric learning 에 해당되는 것이다.</p><p><img data-src="/assets/img/2021-09-08/dataset.png" alt="image" data-proofer-ignore></p><p>CNN Architecture은 아래 표와 같다.</p><p><img data-src="/assets/img/2021-09-08/archi.png" alt="image" data-proofer-ignore></p><p>표를 보면,두 개의 convolutional layer과 여섯 개의 residual 블록을 가진 큰 residual network를 사용하는 ResNet 구조를 가진다.</p><p>결과적으로 전체 feature map은 차원 128의 크기를 가지고, dense layer 10에서 계산된다.</p><p>마지막에 batch와 L2 normalization에서는 정규화를 통해 cosine appearance metric와 호환될 수 있도록 features을 재해석한다.</p><p>이 네트워크에는 총 280만 개의 매개변수를 가지고 있다.</p><h2 id="experiments">Experiments <a href="#experiments" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/2021-09-10/Deepsortexp.png" alt="image" data-proofer-ignore></p><p>우리는 MOT16 benchmark에서 움직이는 카메라와 하향식 감시 설정을 포함한 7가지의 까다로운 테스트 시퀀스에서의 tracking 성능을 평가했다.</p><p>tracker의 입력은 detector에 의존했고, 뛰어난 성능을 보이기 위해 수많은 dataset을 통해 Fast RCNN을 훈련시켰다.</p><p>공정한 비교를 위해 동일한 detection에서 SORT를 다시 진행했다.</p><p>평가는 ⋋ = 0 및 Amax = 30 frame을 사용하여 수행했고, detection의 threshold = 0.3 을 사용했다.</p><p>benchmark에서 제공하는 매개변수로는 :</p><ul><li>MOTA(↑) : 다중 객체 tracking accuracy<li>MOTP(↑) : 다중 객체 tracking precision<li>FAF(↓) : 프레임 당 잘못 판정된 수<li>MT(↑) : 주로 추적되는 궤적의 수. 즉, 타겟은 수명의 최소 80%에 대해 동일한 레이블<li>ML(↓) : 대부분 손실된 궤적의 수. 즉, 타겟의 수명의 최소 20% 동안 추적되지 않은 레이블<li>ID SW(↓) : ID가 다른 객체로 전환된 횟수<li>Frag(↓) : miss detection에 의해 추적이 중단된 fragmentation 수</ul><p>(↑) 는 점수가 높을수록 좋은 성능을 나타내고, (↓) 는 반대다.</p><p>실험 결과 Identity switches를 1423개에서 781개, 약 45%를 성공적으로 줄였다.</p><p>동시에 occlusion과 miss인 객체도 제거하지 않고 인식함으로써 객체 identity가 유지되면서 track fragmentation도 약간 증가했다.</p><p>외형 정보 통합(appearance informantion integration)으로 인해, 더 긴 occlusion에도 identities를 성공적으로 유지했다.</p><p>deep sort는 다른 tracker과 비교하더라도 좋은 성능을 유지하면서 모든 online 방법 중 가장 적은 ID 스위치를 반환한다.</p><p>또한, 상대적으로 큰 maximum track age를 설정함으로써 더 많은 양의 track들이 제거되지 않고, 물체 궤적에 결합된다.</p><p>잘못 판단된 track이 감소되었으며, 비교적 안정적인 고정 track들을 생성한다.</p><h2 id="conclusion">Conclusion <a href="#conclusion" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">pretrained association metric</code>을 통해 appearance information을 통합하는, SORT의 확장인 deep sort를 제시했다. 그 결과 더 오랜 기간 동안 occlusion 상태를 추적할 수 있었다.</p><h2 id="refernece">Refernece <a href="#refernece" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>Simple Online and Realtime Tracking With A Deep Association Metric (21 Mar 2017) Nicolai Wojke, Alex Bewley, Dietrich Paulus page : https://arxiv.org/abs/1703.07402v1<li>https://velog.io/@kimkj38/%EB%85%BC%EB%AC%B8-%EB%A6%AC%EB%B7%B0-Deep-SORTSimple-Online-and-Realtime-Tracking-with-a-Deep-Association-Metric<li>https://kau-deeperent.tistory.com/84<li>https://kimyo-s.tistory.com/46</ul><p><br /> 코드</p><ul><li>github https://github.com/ZQPei/deep_sort_pytorch#training-the-re-id-model<li>github https://github.com/nwojke/deep_sort<li>blog https://minding-deep-learning.tistory.com/6<li>blog https://jjeamin.github.io/posts/deepsort/</ul></div><div class="post-tail-wrapper text-muted"><div style="text-align: left;"> <a href="http://hits.dwyl.com/dkssud8150.github.io/posts/Deepsort/" target="_blank"> <img data-src="http://hits.dwyl.com/dkssud8150.github.io/posts/Deepsort.svg" data-proofer-ignore> </a></div><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/review/'>Review</a>, <a href='/categories/tracking/'>Tracking</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tracking/" class="post-tag no-text-decoration" >Tracking</a> <a href="/tags/deep-sort/" class="post-tag no-text-decoration" >Deep SORT</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Simple Online and Realtime Tracking With a Deep Association Metric - JaeHo Yoon&amp;url=https://dkssud8150.github.io/posts/Deepsort/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Simple Online and Realtime Tracking With a Deep Association Metric - JaeHo Yoon&amp;u=https://dkssud8150.github.io/posts/Deepsort/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://dkssud8150.github.io/posts/Deepsort/&amp;text=Simple Online and Realtime Tracking With a Deep Association Metric - JaeHo Yoon" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://dkssud8150.github.io/posts/Deepsort/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6611243953442169" crossorigin="anonymous"></script></div><script src="https://utteranc.es/client.js" repo="dkssud8150/dkssud8150.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/gitpage/">[깃허브 프로필 꾸미기] github 프로필 만들기</a><li><a href="/posts/product/">[깃허브 프로필 꾸미기] productive box 만들기</a><li><a href="/posts/regex/">[데브코스] 2주차 - linux 기초(REGEX)</a><li><a href="/posts/Kfold/">KFold Cross Validation 과 StratifiedKFold</a><li><a href="/posts/cmake/">[데브코스] 17주차 - CMake OpenCV, Eigen, Pangolin install </a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/devcourse/">devcourse</a> <a class="post-tag" href="/tags/deeplearning/">deeplearning</a> <a class="post-tag" href="/tags/cs231n/">CS231N</a> <a class="post-tag" href="/tags/ros/">ros</a> <a class="post-tag" href="/tags/coding-test/">coding test</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/kooc/">kooc</a> <a class="post-tag" href="/tags/opencv/">OpenCV</a> <a class="post-tag" href="/tags/pytorch-tutorial/">pytorch tutorial</a> <a class="post-tag" href="/tags/autonomous-driving/">Autonomous Driving</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/SORT/"><div class="card-body"> <em class="timeago small" date="2021-09-06 13:00:00 +0900" >Sep 6, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Simple Online and Realtime Tracking</h3><div class="text-muted small"><p> Simple Online and Realtime Tracking 에 대한 논문을 리뷰한 내용입니다. 혼자 공부하기 위해 정리한 내용으로 이해가 안되는 부분들이 많을 거라 생각됩니다. 참고용으로만 봐주세요. 이 논문은 1076회 인용된 논문으로 tracking 에서 유명한 논문입니다. Abstract 이 논문은 Realtime application ...</p></div></div></a></div><div class="card"> <a href="/posts/yolo_Deepsort/"><div class="card-body"> <em class="timeago small" date="2021-09-10 13:00:00 +0900" >Sep 10, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Yolov4 + Deep SORT 를 이용한 스포츠 선수 tracking</h3><div class="text-muted small"><p> 논문 읽어보기 Yolo v4 와 Deep Sort 를 통해 visual tracking 하는 블로그 찾아보기 toy project 로 르브론 제임스 농구 영상 tracking 해보기 git clone 을 통해 tracking 해보기 Reference http://ieeexplore.ieee.org.ssl.access.inu.ac...</p></div></div></a></div><div class="card"> <a href="/posts/pointcnn2/"><div class="card-body"> <em class="timeago small" date="2022-01-23 13:00:00 +0900" >Jan 23, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[논문 코드 구현] PointCNN: Convolution on X-transformed points</h3><div class="text-muted small"><p> pointCNN 깃허브에 올라와 있는 코드를 직접 실행하고 리뷰한 내용입니다. 모든 코드는 colab에서 진행하였습니다. 논문에 대한 리뷰가 궁금하신 분들은 이 링크를 참고해주세요. PointCNN 깃허브 주소: https://github.com/yangyanli/PointCNN Classification ModelNet40 먼저 분류 모...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/SORT/" class="btn btn-outline-primary" prompt="Older"><p>Simple Online and Realtime Tracking</p></a> <a href="/posts/yolo_Deepsort/" class="btn btn-outline-primary" prompt="Newer"><p>Yolov4 + Deep SORT 를 이용한 스포츠 선수 tracking</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">JaeHo YooN</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/devcourse/">devcourse</a> <a class="post-tag" href="/tags/deeplearning/">deeplearning</a> <a class="post-tag" href="/tags/cs231n/">CS231N</a> <a class="post-tag" href="/tags/ros/">ros</a> <a class="post-tag" href="/tags/coding-test/">coding test</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/kooc/">kooc</a> <a class="post-tag" href="/tags/opencv/">OpenCV</a> <a class="post-tag" href="/tags/pytorch-tutorial/">pytorch tutorial</a> <a class="post-tag" href="/tags/autonomous-driving/">Autonomous Driving</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-NC7MWHVXJE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NC7MWHVXJE'); }); </script>