<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="[데브코스] 4주차 - ROS auto driving using Sensor" /><meta name="author" content="JaeHo YooN" /><meta property="og:locale" content="en" /><meta name="description" content="Do focus on developing ‘your ability’ rather than waste time on making you famous." /><meta property="og:description" content="Do focus on developing ‘your ability’ rather than waste time on making you famous." /><link rel="canonical" href="https://dkssud8150.github.io/posts/rviz/" /><meta property="og:url" content="https://dkssud8150.github.io/posts/rviz/" /><meta property="og:site_name" content="JaeHo Yoon" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-08T19:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[데브코스] 4주차 - ROS auto driving using Sensor" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@JaeHo YooN" /><meta name="google-site-verification" content="znvuGsQGYxMZPBslC4XG6doCYao6Y-fWibfGlcaMHH8" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"JaeHo YooN"},"dateModified":"2022-05-02T16:15:21+09:00","datePublished":"2022-03-08T19:00:00+09:00","description":"Do focus on developing ‘your ability’ rather than waste time on making you famous.","headline":"[데브코스] 4주차 - ROS auto driving using Sensor","mainEntityOfPage":{"@type":"WebPage","@id":"https://dkssud8150.github.io/posts/rviz/"},"url":"https://dkssud8150.github.io/posts/rviz/"}</script><title>[데브코스] 4주차 - ROS auto driving using Sensor | JaeHo Yoon</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="JaeHo Yoon"><meta name="application-name" content="JaeHo Yoon"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/shin_chan.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">JaeHo Yoon</a></div><div class="site-subtitle font-italic">Mamba Mentality</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fab fa-angellist ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/dkssud8150" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hoya58150','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.notion.so/18490713817d403696812c57d0abe730" aria-label="notion" target="_blank" rel="noopener"> <i class="fab fa-battle-net"></i> </a> <a href="https://www.linkedin.com/in/jaeho-yoon-90b62b230" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.instagram.com/jai_ho8150/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[데브코스] 4주차 - ROS auto driving using Sensor </span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[데브코스] 4주차 - ROS auto driving using Sensor</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/dkssud8150">JaeHo YooN</a> </em></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6611243953442169" crossorigin="anonymous"></script><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-03-08 19:00:00 +0900" data-toggle="tooltip" data-placement="bottom" title="Tue, Mar 8, 2022, 7:00 PM +0900" >Mar 8, 2022</em> </span> <span> Updated <em class="timeago" date="2022-05-02 16:15:21 +0900 " data-toggle="tooltip" data-placement="bottom" title="Mon, May 2, 2022, 4:15 PM +0900" >May 2, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1359 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p><br /></p><h1 id="rviz-기반-오도메트리-활용">RVIZ 기반 오도메트리 활용</h1><h2 id="odometry">odometry <a href="#odometry" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>오도미터(odometry): 차량이나 로봇이 주행하며 이동한 거리를 측정하는 기기 오도메트리(odomerty): 오도미터 등의 기기의 측정값으로 움직이는 사물의 위치를 측정하는 방법</p><p><img data-src="/assets/img/dev/week4/day2/odometry.png" width="50%" data-proofer-ignore> <img data-src="/assets/img/dev/week4/day2/odometry2.png" width="50%" data-proofer-ignore></p><p><br /></p><p>자동차의 이동거리는 바퀴의 회전수로 계산한다.</p><p><img data-src="/assets/img/dev/week4/day2/tire.png" data-proofer-ignore></p><p><br /></p><p>핸들을 꺽을 때 앞 바퀴 두개가 서로 다르다. 이유는 원을 그렸다고 생각했을 때 안쪽 바퀴는 바깥 바퀴보다 꺽여야 할 각도가 더 많이 꺽여야 한다. 계산하는 방법은 뒷바퀴를 기준으로 연장선을 긋고, 앞바퀴 두개의 각각 연장선이 동심원에서 만나야 한다.</p><p><img data-src="/assets/img/dev/week4/day2/handling_issue.jpeg" data-proofer-ignore></p><p>이를 간단하게 구하는 방법을 정의한 것이 Ackermann Steering이다.</p><p><img data-src="/assets/img/dev/week4/day2/ackermann.png" width="30%" data-proofer-ignore> <img data-src="/assets/img/dev/week4/day2/ackermann2.png" width="50%" data-proofer-ignore></p><p>스티어링을 하나 만들어서 그 각도는 뒷바퀴의 중심에만 가도록 만들게 되면 두 개의 바퀴는 항상 동심원을 가진다는 것이다. 그러나 두개의 각도를 각각 구하는 것은 복잡하기 때문에 두 바퀴의 중간점에서의 각도로 정의한다.</p><p><img data-src="/assets/img/dev/week4/day2/ackermann3.png" data-proofer-ignore></p><p><br /></p><p><br /></p><h2 id="자동차-위치-정보">자동차 위치 정보 <a href="#자동차-위치-정보" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/dev/week4/day2/car_point.png" data-proofer-ignore></p><ul><li>현재 위치 : (x,y) 좌표 + theta<ul><li>(x,y): 현재 뒷바퀴의 위치<li>theta: 직교좌표계의 x축과 차량의 수직선이 이루는 각도</ul><li>이동 속도 : 선속도 v + 각속도 w<li>조향각 델타<ul><li>델타: 앞바퀴와 도착하고자 하는 뒷바퀴의 위치와, 현재 차량의 수직선이 이루는 각도</ul></ul><p><br /></p><p><br /></p><h2 id="odometry-토픽">odometry 토픽 <a href="#odometry-토픽" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>/odom이라는 토픽을 발행하는 예제 코드가 있다. 파이썬 코드 : ros_odometry_publisher_example.py <a href="https://gist.github.com/atotto/f2754f75bedb6ea56e3e0264ec405dcf">https://gist.github.com/atotto/f2754f75bedb6ea56e3e0264ec405dcf</a></p><p>파일이름은 각자 변경가능하다.</p><p>아래 파일을 ex_urdf 파일에 추가한다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span>
<span class="c1"># name change ros_odometry_publisher_example.py -&gt; odom_publisher_ex.py
</span><span class="kn">import</span> <span class="n">math</span>
<span class="kn">from</span> <span class="n">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>

<span class="kn">import</span> <span class="n">rospy</span>
<span class="kn">import</span> <span class="n">tf</span>
<span class="kn">from</span> <span class="n">nav_msgs.msg</span> <span class="kn">import</span> <span class="n">Odometry</span>
<span class="kn">from</span> <span class="n">geometry_msgs.msg</span> <span class="kn">import</span> <span class="n">Point</span><span class="p">,</span> <span class="n">Pose</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">,</span> <span class="n">Twist</span><span class="p">,</span> <span class="n">Vector3</span>

<span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="s">'odometry_publisher'</span><span class="p">)</span> <span class="c1"># odomety_publisher 노드 생성
</span>
<span class="n">odom_pub</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Publisher</span><span class="p">(</span><span class="s">"odom"</span><span class="p">,</span> <span class="n">Odometry</span><span class="p">,</span> <span class="n">queue_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> <span class="c1"># odom 토픽 발행 준비
</span><span class="n">odom_broadcaster</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="nc">TransformBroadcaster</span><span class="p">()</span>

<span class="c1"># 초기 위치
</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">th</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1"># 초기 속도 x축 속도는 10cm/s, y축 속도는 -10cm/s, 주행 방향은 0.1라디안(5.7도)
</span><span class="n">vx</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">vy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
<span class="n">vth</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1"># 시간 정보 계산용 변수
</span><span class="n">current_time</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span> 
<span class="n">last_time</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Rate</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># 1초에 한번씩 돌기
</span><span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="p">.</span><span class="nf">is_shutdown</span><span class="p">():</span>
    <span class="n">current_time</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>

    <span class="c1"># compute odometry in a typical way given the velocities of the robot
</span>    <span class="c1"># 그림1 참고
</span>    <span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_time</span> <span class="o">-</span> <span class="n">last_time</span><span class="p">).</span><span class="nf">to_sec</span><span class="p">()</span> <span class="c1"># 델타 시간
</span>    <span class="n">delta_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">vx</span> <span class="o">*</span> <span class="nf">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span> <span class="o">-</span> <span class="n">vy</span> <span class="o">*</span> <span class="nf">sin</span><span class="p">(</span><span class="n">th</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span> <span class="c1"># 속도 x 시간 = 거리
</span>    <span class="n">delta_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">vx</span> <span class="o">*</span> <span class="nf">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span> <span class="o">+</span> <span class="n">vy</span> <span class="o">*</span> <span class="nf">cos</span><span class="p">(</span><span class="n">th</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">delta_th</span> <span class="o">=</span> <span class="n">vth</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="n">delta_x</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="n">delta_y</span>
    <span class="n">th</span> <span class="o">+=</span> <span class="n">delta_th</span>

    <span class="c1"># since all odometry is 6DOF we'll need a quaternion created from yaw
</span>    <span class="c1"># 오일러 좌표계 회전을 쿼터니언 값으로 계산함
</span>    <span class="n">odom_quat</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">transformations</span><span class="p">.</span><span class="nf">quaternion_from_euler</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">th</span><span class="p">)</span> <span class="c1"># 아래 좌표계 회전 설명 참고
</span>
    <span class="c1"># first, we'll publish the transform over tf
</span>    <span class="n">odom_broadcaster</span><span class="p">.</span><span class="nf">sendTransform</span><span class="p">(</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="c1"># 위치 정보애 대한 발행 준비
</span>        <span class="n">odom_quat</span><span class="p">,</span> 
        <span class="n">current_time</span><span class="p">,</span>
        <span class="s">"base_link"</span><span class="p">,</span> <span class="c1"># odom과 base_link를 연결하는 코드
</span>        <span class="s">"odom"</span>
    <span class="p">)</span>

    <span class="c1"># next, we'll publish the odometry message over ROS
</span>    <span class="n">odom</span> <span class="o">=</span> <span class="nc">Odometry</span><span class="p">()</span>
    <span class="n">odom</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">stamp</span> <span class="o">=</span> <span class="n">current_time</span>
    <span class="n">odom</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="s">"odom"</span>

    <span class="c1"># set the position
</span>    <span class="n">odom</span><span class="p">.</span><span class="n">pose</span><span class="p">.</span><span class="n">pose</span> <span class="o">=</span> <span class="nc">Pose</span><span class="p">(</span><span class="nc">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="nc">Quaternion</span><span class="p">(</span><span class="o">*</span><span class="n">odom_quat</span><span class="p">))</span>

    <span class="c1"># set the velocity
</span>    <span class="n">odom</span><span class="p">.</span><span class="n">child_frame_id</span> <span class="o">=</span> <span class="s">"base_link"</span>
    <span class="n">odom</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">twist</span> <span class="o">=</span> <span class="nc">Twist</span><span class="p">(</span><span class="nc">Vector3</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nc">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vth</span><span class="p">))</span>

    <span class="c1"># publish the message
</span>    <span class="n">odom_pub</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span><span class="n">odom</span><span class="p">)</span>

    <span class="n">last_time</span> <span class="o">=</span> <span class="n">current_time</span>
    <span class="n">r</span><span class="p">.</span><span class="nf">sleep</span><span class="p">()</span>
</pre></table></code></div></div><p>이 코드가 하는 일</p><ul><li>odometry_publisher노드를 생성<li>거기서 /odom 토픽을 발행<li>1초에 1번씩 발행</ul><p><br /></p><p><strong>이동 속도</strong></p><p>이동 속도는 Vx, Vy의 두 벡터의 합성이다.</p><p><br /></p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 300'%3E%3C/svg%3E" data-src="/assets/img/dev/week4/day2/delta.png" width="400" height="300" caption="그림1" data-proofer-ignore></p><p><strong>좌표계 회전</strong></p><p>좌표축이 회전하는 것이 3가지가 있다. x축 기준으로 회전하는 것을 <strong>roll</strong>, y축 기준으로 회전하는 것을 <strong>pitch</strong>, z축 기준으로 회전하는 것을 <strong>yaw</strong>이라 한다.</p><p>이와 같이 나타내는 것을 오일러 방식이라 한다. 그러나 여기서난 쿼터니언 방식을 사용하는데, 이유는 계산하기 쉽기 때문이다.</p><h3 id="실행">실행 <a href="#실행" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>roscore
<span class="nv">$ </span>rosrun ex_urdf odom_publisher_ex.py
<span class="nv">$ </span>rostopic list
<span class="nv">$ </span>rostopic info odom
<span class="nv">$ </span>rqt_graph
</pre></table></code></div></div><p><img data-src="/assets/img/dev/week4/day2/odom_rqt.png" data-proofer-ignore></p><ul><li>odomety 토픽 : /odom<li>odom 메시지 타입 : nav_msgs/Odometry</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>rosmsg show nav_msgs/Odometry
<span class="nv">$ </span>rostopic <span class="nb">echo </span>odom
</pre></table></code></div></div><p><img data-src="/assets/img/dev/week4/day2/odom_implement.png" caption="그림1" data-proofer-ignore></p><p><img data-src="/assets/img/dev/week4/day2/odom_topicecho.png" caption="그림2" data-proofer-ignore></p><p>position: 뒷바퀴 기준 점 Quaternion orientation: 롤 요키치를 가상의 좌표계로 나타낸 값 vector linear: 선속도 vector angular: 각속도</p><p><br /></p><p><br /></p><h2 id="rviz-가상공간에서-물체-이동시키기">RVIZ 가상공간에서 물체 이동시키기 <a href="#rviz-가상공간에서-물체-이동시키기" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>기존의 odom_publisher_ex.py가 있는 패키지를 이용한다. launch 파일도 생성한다.</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- odom_pub.launch --&gt;</span>
<span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">"model"</span> <span class="nt">/&gt;</span>
    ...
    <span class="c">&lt;!-- add python file --&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"odom_publisher"</span> <span class="na">pkg=</span><span class="s">"ex_urdf"</span> <span class="na">type=</span><span class="s">"odom_publisher_ex.py"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;/launch&gt;</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>roslaunch ex_urdf odom_pub.launch
</pre></table></code></div></div><p><img data-src="/assets/img/dev/week4/day2/odom_rviz.png" data-proofer-ignore></p><p><img data-src="/assets/img/dev/week4/day2/odom_rqt2.png" data-proofer-ignore></p><p>/tf는 어떤 물체의 자세나 이것저것 계산해서 rviz에 쏘는 시각화 노드이다.</p><p><br /></p><p>그래서 직접 RVIZ에서 주행을 시키기 위한 과정으로는</p><ol><li>8자 주행 프로그램이 <code class="language-plaintext highlighter-rouge">/motor 토픽</code>인 모터 제어 메시지를 보낸다.<li>변환 프로그램이 받아서 변환한 후 <code class="language-plaintext highlighter-rouge">/joint_states</code> 토픽으로 만들어 발행<li>토픽을 오도메트리 프로그램이 받아서 변환해서 <code class="language-plaintext highlighter-rouge">/odom</code> 토픽으로 만들어 발행</ol></div><div class="post-tail-wrapper text-muted"><div style="text-align: left;"> <a href="http://hits.dwyl.com/dkssud8150.github.io/posts/rviz/" target="_blank"> <img data-src="http://hits.dwyl.com/dkssud8150.github.io/posts/rviz.svg" data-proofer-ignore> </a></div><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/classlog/'>Classlog</a>, <a href='/categories/devcourse/'>devcourse</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/rviz/" class="post-tag no-text-decoration" >rviz</a> <a href="/tags/ros/" class="post-tag no-text-decoration" >ros</a> <a href="/tags/devcourse/" class="post-tag no-text-decoration" >devcourse</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[데브코스] 4주차 - ROS auto driving using Sensor - JaeHo Yoon&amp;url=https://dkssud8150.github.io/posts/rviz/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[데브코스] 4주차 - ROS auto driving using Sensor - JaeHo Yoon&amp;u=https://dkssud8150.github.io/posts/rviz/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://dkssud8150.github.io/posts/rviz/&amp;text=[데브코스] 4주차 - ROS auto driving using Sensor - JaeHo Yoon" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://dkssud8150.github.io/posts/rviz/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6611243953442169" crossorigin="anonymous"></script></div><script src="https://utteranc.es/client.js" repo="dkssud8150/dkssud8150.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/gitpage/">[깃허브 프로필 꾸미기] github 프로필 만들기</a><li><a href="/posts/product/">[깃허브 프로필 꾸미기] productive box 만들기</a><li><a href="/posts/regex/">[데브코스] 2주차 - linux 기초(REGEX)</a><li><a href="/posts/Kfold/">KFold Cross Validation 과 StratifiedKFold</a><li><a href="/posts/cmake/">[데브코스] 17주차 - CMake OpenCV, Eigen, Pangolin install </a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/devcourse/">devcourse</a> <a class="post-tag" href="/tags/deeplearning/">deeplearning</a> <a class="post-tag" href="/tags/cs231n/">CS231N</a> <a class="post-tag" href="/tags/ros/">ros</a> <a class="post-tag" href="/tags/coding-test/">coding test</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/kooc/">kooc</a> <a class="post-tag" href="/tags/opencv/">OpenCV</a> <a class="post-tag" href="/tags/pytorch-tutorial/">pytorch tutorial</a> <a class="post-tag" href="/tags/autonomous-driving/">Autonomous Driving</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/lidar1/"><div class="card-body"> <em class="timeago small" date="2022-03-10 16:14:00 +0900" >Mar 10, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[데브코스] 4주차 - ROS nodes and topics for lidar sensors</h3><div class="text-muted small"><p> 라이다 센서 ROS 패키지 라이다 센서 ROS 패키지를 xycar_lidar로 만든다. 토픽의 이름은 /scan으로 할 것이다. /scan 토픽안에는 타입 : sensor_msgs\/LaserScan 구성 std_msgs/Header header # 시퀀스 번호, 시간, 아이디를 담는다. uid32 seq ...</p></div></div></a></div><div class="card"> <a href="/posts/rvizsensorfusion/"><div class="card-body"> <em class="timeago small" date="2022-03-10 22:14:00 +0900" >Mar 10, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[데브코스] 4주차 - ROS Motor and sensor integration in RVIZ</h3><div class="text-muted small"><p> RVIZ에서 모터와 센서 통합하기 RVIZ 가상공간에서 8자 주행하는 자이카에 라이다 센서와 IMU센서의 뷰어를 통합해본다. 3D 모델링된 차량이 8자 주행을 하면서 주변 장애물가지의 거리값을 Range로 표시하고 IMU 센싱값에 따라 차체가 기울어지도록 한다. driver노드 -&amp;gt; /xycar_motor토픽 -&amp;gt; conve...</p></div></div></a></div><div class="card"> <a href="/posts/sensordriving/"><div class="card-body"> <em class="timeago small" date="2022-03-11 16:14:00 +0900" >Mar 11, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[데브코스] 4주차 - ROS Self-driving using sensors</h3><div class="text-muted small"><p> 라이다를 통한 장애물 회피 lidar_drive 패키지를 사용 lidar_gostop.py , lidar_gostop.launch 1 2 3 4 5 6 &amp;lt;!-- lidar_gostop.launch --&amp;gt; &amp;lt;launch&amp;gt; &amp;lt;include file=&quot;$(find xycar_motor)/launch/xyc...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/pygame/" class="btn btn-outline-primary" prompt="Older"><p>[데브코스] 4주차 - ROS Develop Pygame</p></a> <a href="/posts/sensor2/" class="btn btn-outline-primary" prompt="Newer"><p>[데브코스] 4주차 - ROS Sensor devices</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">JaeHo YooN</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/devcourse/">devcourse</a> <a class="post-tag" href="/tags/deeplearning/">deeplearning</a> <a class="post-tag" href="/tags/cs231n/">CS231N</a> <a class="post-tag" href="/tags/ros/">ros</a> <a class="post-tag" href="/tags/coding-test/">coding test</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/kooc/">kooc</a> <a class="post-tag" href="/tags/opencv/">OpenCV</a> <a class="post-tag" href="/tags/pytorch-tutorial/">pytorch tutorial</a> <a class="post-tag" href="/tags/autonomous-driving/">Autonomous Driving</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-NC7MWHVXJE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NC7MWHVXJE'); }); </script>